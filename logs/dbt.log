

============================== 2022-02-28 23:21:26.815286 | b0dffb6f-47f4-44a3-ab2b-59c428e5e369 ==============================
23:21:26.815286 [info ] [MainThread]: Running with dbt=1.0.3
23:21:26.816842 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=True, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:21:26.817081 [debug] [MainThread]: Tracking: tracking
23:21:26.828408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dbaf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dbaf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dc52e50>]}
23:21:26.828774 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ubuntu/.dbt
23:21:26.830982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dbaf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dc52f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5dc52ac0>]}


============================== 2022-02-28 23:23:25.379003 | a74bc2f0-f477-4f08-8a84-68e4c8a540ac ==============================
23:23:25.379003 [info ] [MainThread]: Running with dbt=1.0.3
23:23:25.380516 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:23:25.380769 [debug] [MainThread]: Tracking: tracking
23:23:25.392001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da26fd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da26fd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da279ff40>]}
23:23:25.427056 [debug] [MainThread]: Executing "git --help"
23:23:25.431434 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:23:25.431865 [debug] [MainThread]: STDERR: "b''"
23:23:25.434826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da275a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da26d5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da26d5550>]}


============================== 2022-02-28 23:30:09.514318 | 25903436-443b-4ff5-98b9-98b8c175146b ==============================
23:30:09.514318 [info ] [MainThread]: Running with dbt=1.0.3
23:30:09.515766 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:30:09.516007 [debug] [MainThread]: Tracking: tracking
23:30:09.527442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af58bb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af58bb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af595de80>]}
23:30:09.559938 [debug] [MainThread]: Executing "git --help"
23:30:09.564250 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:30:09.564695 [debug] [MainThread]: STDERR: "b''"
23:30:09.567658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af5916610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af58926a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af5892550>]}


============================== 2022-02-28 23:37:36.239124 | 6f637b7e-d096-49d0-8258-b458bbfa8e75 ==============================
23:37:36.239124 [info ] [MainThread]: Running with dbt=1.0.3
23:37:36.240786 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:37:36.241021 [debug] [MainThread]: Tracking: tracking
23:37:36.252111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04736190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04736340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b047d9e50>]}
23:37:36.592778 [debug] [MainThread]: Executing "git --help"
23:37:36.597245 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:37:36.597679 [debug] [MainThread]: STDERR: "b''"
23:37:36.605488 [debug] [MainThread]: Acquiring new bigquery connection "debug"
23:37:36.606340 [debug] [MainThread]: Opening a new connection, currently in state init
23:37:37.139173 [debug] [MainThread]: On debug: select 1 as id
23:37:38.290150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b039f81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b039bd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04736190>]}
23:37:38.370804 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-02-28 23:37:43.395878 | b101a096-473e-4c7d-82eb-57e361e0c567 ==============================
23:37:43.395878 [info ] [MainThread]: Running with dbt=1.0.3
23:37:43.401668 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:37:43.401950 [debug] [MainThread]: Tracking: tracking
23:37:43.419094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dde25f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dde25f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dde25f8b0>]}
23:37:43.448909 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
23:37:43.451119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dde2ad070>]}
23:37:43.479100 [debug] [MainThread]: Parsing macros/catalog.sql
23:37:43.488193 [debug] [MainThread]: Parsing macros/etc.sql
23:37:43.490678 [debug] [MainThread]: Parsing macros/adapters.sql
23:37:43.519174 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
23:37:43.537836 [debug] [MainThread]: Parsing macros/materializations/seed.sql
23:37:43.541026 [debug] [MainThread]: Parsing macros/materializations/table.sql
23:37:43.545666 [debug] [MainThread]: Parsing macros/materializations/copy.sql
23:37:43.548807 [debug] [MainThread]: Parsing macros/materializations/view.sql
23:37:43.551869 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
23:37:43.553936 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:37:43.556811 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:37:43.561528 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:37:43.568807 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:37:43.588640 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:37:43.609455 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:37:43.622823 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:37:43.636710 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:37:43.638851 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:37:43.640659 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:37:43.654768 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:37:43.666880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:37:43.672349 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:37:43.691146 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:37:43.694134 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:37:43.697330 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:37:43.698955 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:37:43.706966 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:37:43.710506 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:37:43.719071 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:37:43.721344 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:37:43.723478 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:37:43.728798 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:37:43.730469 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:37:43.731543 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:37:43.732260 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:37:43.733158 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:37:43.735096 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:37:43.738117 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:37:43.739942 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:37:43.750137 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:37:43.755601 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:37:43.764420 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:37:43.767916 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:37:43.779887 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:37:43.791535 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:37:43.794378 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:37:43.798172 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:37:43.803601 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:37:44.067585 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
23:37:44.081276 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
23:37:44.083950 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
23:37:44.139186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

23:37:44.148742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dddf5ceb0>]}
23:37:44.154687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dde2ad340>]}
23:37:44.155099 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
23:37:44.157543 [info ] [MainThread]: 
23:37:44.158902 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:37:44.159938 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
23:37:44.160247 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:37:44.910979 [debug] [ThreadPool]: Acquiring new bigquery connection "create_ae-project-341501_coffee_shop"
23:37:44.911469 [debug] [ThreadPool]: Acquiring new bigquery connection "create_ae-project-341501_coffee_shop"
23:37:44.911671 [debug] [ThreadPool]: BigQuery adapter: Creating schema "ae-project-341501.coffee_shop".
23:37:44.911854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:37:45.340707 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
23:37:45.341058 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:37:45.543551 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
23:37:45.545113 [info ] [MainThread]: 
23:37:45.553489 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
23:37:45.553823 [info ] [Thread-1  ]: 1 of 3 START view model coffee_shop.customers................................... [RUN]
23:37:45.554180 [debug] [Thread-2  ]: Began running node model.coffee_shop.my_first_dbt_model
23:37:45.554430 [info ] [Thread-2  ]: 2 of 3 START table model coffee_shop.my_first_dbt_model......................... [RUN]
23:37:45.555791 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
23:37:45.555981 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
23:37:45.556213 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
23:37:45.558207 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
23:37:45.558837 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop.my_first_dbt_model"
23:37:45.559684 [debug] [Thread-2  ]: Began compiling node model.coffee_shop.my_first_dbt_model
23:37:45.559857 [debug] [Thread-2  ]: Compiling model.coffee_shop.my_first_dbt_model
23:37:45.562853 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
23:37:45.563302 [debug] [Thread-2  ]: finished collecting timing info
23:37:45.563491 [debug] [Thread-2  ]: Began executing node model.coffee_shop.my_first_dbt_model
23:37:45.569753 [debug] [Thread-1  ]: finished collecting timing info
23:37:45.569945 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
23:37:45.636354 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
23:37:45.636945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:37:45.637210 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`customers`
  OPTIONS()
  as SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at;;


23:37:45.641559 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop.my_first_dbt_model"
23:37:45.642020 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:37:45.642237 [debug] [Thread-2  ]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
23:37:45.959193 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/49def55a-9092-4a11-8012-472c2b207a2e?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected end of input but got ";" at [14:25]')
23:37:46.884998 [debug] [Thread-1  ]: finished collecting timing info
23:37:46.885523 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got ";" at [14:25]
  compiled SQL at target/run/coffee_shop/models/customers.sql
23:37:46.885900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddc5bc580>]}
23:37:46.886349 [error] [Thread-1  ]: 1 of 3 ERROR creating view model coffee_shop.customers.......................... [[31mERROR[0m in 1.33s]
23:37:46.887905 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
23:37:48.046095 [debug] [Thread-2  ]: finished collecting timing info
23:37:48.046695 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddd69dbe0>]}
23:37:48.047124 [info ] [Thread-2  ]: 2 of 3 OK created table model coffee_shop.my_first_dbt_model.................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.49s]
23:37:48.048830 [debug] [Thread-2  ]: Finished running node model.coffee_shop.my_first_dbt_model
23:37:48.049550 [debug] [Thread-4  ]: Began running node model.coffee_shop.my_second_dbt_model
23:37:48.049857 [info ] [Thread-4  ]: 3 of 3 START view model coffee_shop.my_second_dbt_model......................... [RUN]
23:37:48.051149 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop.my_second_dbt_model"
23:37:48.051350 [debug] [Thread-4  ]: Began compiling node model.coffee_shop.my_second_dbt_model
23:37:48.051529 [debug] [Thread-4  ]: Compiling model.coffee_shop.my_second_dbt_model
23:37:48.054865 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
23:37:48.055267 [debug] [Thread-4  ]: finished collecting timing info
23:37:48.055447 [debug] [Thread-4  ]: Began executing node model.coffee_shop.my_second_dbt_model
23:37:48.058506 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop.my_second_dbt_model"
23:37:48.058905 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:37:48.059149 [debug] [Thread-4  ]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id = 1;


23:37:48.985441 [debug] [Thread-4  ]: finished collecting timing info
23:37:48.985984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b101a096-473e-4c7d-82eb-57e361e0c567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddc611eb0>]}
23:37:48.986371 [info ] [Thread-4  ]: 3 of 3 OK created view model coffee_shop.my_second_dbt_model.................... [[32mOK[0m in 0.94s]
23:37:48.987828 [debug] [Thread-4  ]: Finished running node model.coffee_shop.my_second_dbt_model
23:37:48.989312 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:37:48.989708 [info ] [MainThread]: 
23:37:48.990815 [info ] [MainThread]: Finished running 2 view models, 1 table model in 4.83s.
23:37:48.991962 [debug] [MainThread]: Connection 'master' was properly closed.
23:37:48.992149 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
23:37:48.992298 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
23:37:48.992436 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
23:37:49.000945 [info ] [MainThread]: 
23:37:49.002464 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:37:49.003581 [info ] [MainThread]: 
23:37:49.004639 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
23:37:49.005708 [error] [MainThread]:   Syntax error: Expected end of input but got ";" at [14:25]
23:37:49.006806 [error] [MainThread]:   compiled SQL at target/run/coffee_shop/models/customers.sql
23:37:49.007924 [info ] [MainThread]: 
23:37:49.008982 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
23:37:49.010182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddc5cee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddd69d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddd69d310>]}


============================== 2022-02-28 23:42:38.372671 | a72e9fce-ea2e-4b02-b741-4fbd10972079 ==============================
23:42:38.372671 [info ] [MainThread]: Running with dbt=1.0.3
23:42:38.376959 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:42:38.377247 [debug] [MainThread]: Tracking: tracking
23:42:38.400985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada23c2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada23c25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada23c28e0>]}
23:42:38.461139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:42:38.461667 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
23:42:38.474705 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
23:42:38.493127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

23:42:38.502998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72e9fce-ea2e-4b02-b741-4fbd10972079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada23257c0>]}
23:42:38.508890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72e9fce-ea2e-4b02-b741-4fbd10972079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada2335dc0>]}
23:42:38.509284 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
23:42:38.511522 [info ] [MainThread]: 
23:42:38.518251 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:42:38.519305 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
23:42:38.519618 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:42:39.299447 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
23:42:39.299864 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:42:39.447636 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
23:42:39.449205 [info ] [MainThread]: 
23:42:39.454791 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
23:42:39.455147 [info ] [Thread-1  ]: 1 of 3 START view model coffee_shop.customers................................... [RUN]
23:42:39.455513 [debug] [Thread-2  ]: Began running node model.coffee_shop.my_first_dbt_model
23:42:39.455769 [info ] [Thread-2  ]: 2 of 3 START table model coffee_shop.my_first_dbt_model......................... [RUN]
23:42:39.457150 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
23:42:39.457342 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
23:42:39.457565 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
23:42:39.459592 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
23:42:39.459993 [debug] [Thread-1  ]: finished collecting timing info
23:42:39.460187 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
23:42:39.466220 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop.my_first_dbt_model"
23:42:39.466420 [debug] [Thread-2  ]: Began compiling node model.coffee_shop.my_first_dbt_model
23:42:39.466587 [debug] [Thread-2  ]: Compiling model.coffee_shop.my_first_dbt_model
23:42:39.469836 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
23:42:39.470211 [debug] [Thread-2  ]: finished collecting timing info
23:42:39.470388 [debug] [Thread-2  ]: Began executing node model.coffee_shop.my_first_dbt_model
23:42:39.508887 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:42:39.520419 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
23:42:39.520906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:42:39.521149 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`customers`
  OPTIONS()
  as SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at;


23:42:39.715392 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop.my_first_dbt_model"
23:42:39.715861 [debug] [Thread-2  ]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
23:42:40.339780 [debug] [Thread-1  ]: finished collecting timing info
23:42:40.340337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72e9fce-ea2e-4b02-b741-4fbd10972079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8877b640>]}
23:42:40.340802 [info ] [Thread-1  ]: 1 of 3 OK created view model coffee_shop.customers.............................. [[32mOK[0m in 0.88s]
23:42:40.342310 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
23:42:41.877338 [debug] [Thread-2  ]: finished collecting timing info
23:42:41.877870 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72e9fce-ea2e-4b02-b741-4fbd10972079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad887cfd60>]}
23:42:41.878265 [info ] [Thread-2  ]: 2 of 3 OK created table model coffee_shop.my_first_dbt_model.................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.41s]
23:42:41.879729 [debug] [Thread-2  ]: Finished running node model.coffee_shop.my_first_dbt_model
23:42:41.880408 [debug] [Thread-4  ]: Began running node model.coffee_shop.my_second_dbt_model
23:42:41.880701 [info ] [Thread-4  ]: 3 of 3 START view model coffee_shop.my_second_dbt_model......................... [RUN]
23:42:41.881878 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop.my_second_dbt_model"
23:42:41.882064 [debug] [Thread-4  ]: Began compiling node model.coffee_shop.my_second_dbt_model
23:42:41.882236 [debug] [Thread-4  ]: Compiling model.coffee_shop.my_second_dbt_model
23:42:41.885377 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
23:42:41.885768 [debug] [Thread-4  ]: finished collecting timing info
23:42:41.886075 [debug] [Thread-4  ]: Began executing node model.coffee_shop.my_second_dbt_model
23:42:41.888846 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop.my_second_dbt_model"
23:42:41.889230 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:42:41.889469 [debug] [Thread-4  ]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id = 1;


23:42:42.673647 [debug] [Thread-4  ]: finished collecting timing info
23:42:42.674173 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72e9fce-ea2e-4b02-b741-4fbd10972079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8875e0d0>]}
23:42:42.674571 [info ] [Thread-4  ]: 3 of 3 OK created view model coffee_shop.my_second_dbt_model.................... [[32mOK[0m in 0.79s]
23:42:42.676049 [debug] [Thread-4  ]: Finished running node model.coffee_shop.my_second_dbt_model
23:42:42.677515 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:42:42.677913 [info ] [MainThread]: 
23:42:42.678998 [info ] [MainThread]: Finished running 2 view models, 1 table model in 4.16s.
23:42:42.680808 [debug] [MainThread]: Connection 'master' was properly closed.
23:42:42.681001 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
23:42:42.681150 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
23:42:42.681289 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
23:42:42.692323 [info ] [MainThread]: 
23:42:42.693627 [info ] [MainThread]: [32mCompleted successfully[0m
23:42:42.694764 [info ] [MainThread]: 
23:42:42.695761 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
23:42:42.696971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada22f4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada2415190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada1827a60>]}


============================== 2022-02-28 23:50:48.580081 | f2ef1d7e-6062-40b7-8ff2-7648634afd4d ==============================
23:50:48.580081 [info ] [MainThread]: Running with dbt=1.0.3
23:50:48.585055 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:50:48.585343 [debug] [MainThread]: Tracking: tracking
23:50:48.608604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908aca700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908aca640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908aca220>]}
23:50:48.666011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:50:48.666535 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
23:50:48.680128 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
23:50:48.699400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

23:50:48.708915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2ef1d7e-6062-40b7-8ff2-7648634afd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908a0bfa0>]}
23:50:48.714555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2ef1d7e-6062-40b7-8ff2-7648634afd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908a95df0>]}
23:50:48.714943 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
23:50:48.717312 [info ] [MainThread]: 
23:50:48.718783 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:50:48.719799 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
23:50:48.720103 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:50:49.507969 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
23:50:49.508383 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:50:49.702206 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
23:50:49.702907 [info ] [MainThread]: 
23:50:49.708811 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
23:50:49.709170 [info ] [Thread-1  ]: 1 of 3 START table model coffee_shop.customers.................................. [RUN]
23:50:49.709533 [debug] [Thread-2  ]: Began running node model.coffee_shop.my_first_dbt_model
23:50:49.709783 [info ] [Thread-2  ]: 2 of 3 START table model coffee_shop.my_first_dbt_model......................... [RUN]
23:50:49.711656 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
23:50:49.711849 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
23:50:49.712085 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
23:50:49.716748 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
23:50:49.717417 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop.my_first_dbt_model"
23:50:49.718410 [debug] [Thread-2  ]: Began compiling node model.coffee_shop.my_first_dbt_model
23:50:49.718593 [debug] [Thread-2  ]: Compiling model.coffee_shop.my_first_dbt_model
23:50:49.721145 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
23:50:49.721539 [debug] [Thread-2  ]: finished collecting timing info
23:50:49.721734 [debug] [Thread-2  ]: Began executing node model.coffee_shop.my_first_dbt_model
23:50:49.727376 [debug] [Thread-1  ]: finished collecting timing info
23:50:49.727579 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
23:50:49.749369 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:50:49.749989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:50:49.942526 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop.my_first_dbt_model"
23:50:49.943123 [debug] [Thread-2  ]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
23:50:50.070375 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
23:50:50.070872 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
23:50:51.832723 [debug] [Thread-2  ]: finished collecting timing info
23:50:51.833288 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ef1d7e-6062-40b7-8ff2-7648634afd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908737b80>]}
23:50:51.833736 [info ] [Thread-2  ]: 2 of 3 OK created table model coffee_shop.my_first_dbt_model.................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.12s]
23:50:51.835418 [debug] [Thread-2  ]: Finished running node model.coffee_shop.my_first_dbt_model
23:50:51.835889 [debug] [Thread-4  ]: Began running node model.coffee_shop.my_second_dbt_model
23:50:51.836156 [info ] [Thread-4  ]: 3 of 3 START view model coffee_shop.my_second_dbt_model......................... [RUN]
23:50:51.837121 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop.my_second_dbt_model"
23:50:51.837303 [debug] [Thread-4  ]: Began compiling node model.coffee_shop.my_second_dbt_model
23:50:51.837472 [debug] [Thread-4  ]: Compiling model.coffee_shop.my_second_dbt_model
23:50:51.841034 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
23:50:51.841409 [debug] [Thread-4  ]: finished collecting timing info
23:50:51.841588 [debug] [Thread-4  ]: Began executing node model.coffee_shop.my_second_dbt_model
23:50:51.863061 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop.my_second_dbt_model"
23:50:51.863559 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:50:51.863807 [debug] [Thread-4  ]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id = 1;


23:50:52.627813 [debug] [Thread-4  ]: finished collecting timing info
23:50:52.628364 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ef1d7e-6062-40b7-8ff2-7648634afd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490864be80>]}
23:50:52.628797 [info ] [Thread-4  ]: 3 of 3 OK created view model coffee_shop.my_second_dbt_model.................... [[32mOK[0m in 0.79s]
23:50:52.630416 [debug] [Thread-4  ]: Finished running node model.coffee_shop.my_second_dbt_model
23:50:58.057394 [debug] [Thread-1  ]: finished collecting timing info
23:50:58.057946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ef1d7e-6062-40b7-8ff2-7648634afd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49086f4eb0>]}
23:50:58.058343 [info ] [Thread-1  ]: 1 of 3 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.35s]
23:50:58.060044 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
23:50:58.061600 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:50:58.062029 [info ] [MainThread]: 
23:50:58.063315 [info ] [MainThread]: Finished running 2 table models, 1 view model in 9.34s.
23:50:58.064738 [debug] [MainThread]: Connection 'master' was properly closed.
23:50:58.064927 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
23:50:58.065081 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
23:50:58.065227 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
23:50:58.071851 [info ] [MainThread]: 
23:50:58.073486 [info ] [MainThread]: [32mCompleted successfully[0m
23:50:58.074820 [info ] [MainThread]: 
23:50:58.076014 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
23:50:58.077453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49089da7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4908aad130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490870d070>]}


============================== 2022-02-28 23:59:09.152576 | 4e0477ff-4f8d-48ac-b8cf-24e13e88cc15 ==============================
23:59:09.152576 [info ] [MainThread]: Running with dbt=1.0.3
23:59:09.157061 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:59:09.157405 [debug] [MainThread]: Tracking: tracking
23:59:09.180783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cefff700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cefff640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cefff220>]}
23:59:09.240884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
23:59:09.241338 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/monthly_customers.sql
23:59:09.254513 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
23:59:09.273183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

23:59:09.282909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cef42eb0>]}
23:59:09.289102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cefc7eb0>]}
23:59:09.289711 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
23:59:09.292285 [info ] [MainThread]: 
23:59:09.293800 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:09.294912 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
23:59:09.295227 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:10.081658 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
23:59:10.082229 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:59:10.244018 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
23:59:10.245717 [info ] [MainThread]: 
23:59:10.251216 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
23:59:10.251551 [info ] [Thread-1  ]: 1 of 4 START table model coffee_shop.customers.................................. [RUN]
23:59:10.251937 [debug] [Thread-2  ]: Began running node model.coffee_shop.my_first_dbt_model
23:59:10.252202 [info ] [Thread-2  ]: 2 of 4 START table model coffee_shop.my_first_dbt_model......................... [RUN]
23:59:10.253847 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
23:59:10.254043 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
23:59:10.254279 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
23:59:10.257767 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
23:59:10.258500 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop.my_first_dbt_model"
23:59:10.259542 [debug] [Thread-2  ]: Began compiling node model.coffee_shop.my_first_dbt_model
23:59:10.259720 [debug] [Thread-2  ]: Compiling model.coffee_shop.my_first_dbt_model
23:59:10.262201 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
23:59:10.262617 [debug] [Thread-2  ]: finished collecting timing info
23:59:10.262813 [debug] [Thread-2  ]: Began executing node model.coffee_shop.my_first_dbt_model
23:59:10.268385 [debug] [Thread-1  ]: finished collecting timing info
23:59:10.268637 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
23:59:10.288889 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:59:10.291664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:59:10.494912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
23:59:10.495422 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
23:59:10.498226 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop.my_first_dbt_model"
23:59:10.498638 [debug] [Thread-2  ]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
23:59:12.350190 [debug] [Thread-2  ]: finished collecting timing info
23:59:12.350764 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ce468f10>]}
23:59:12.351214 [info ] [Thread-2  ]: 2 of 4 OK created table model coffee_shop.my_first_dbt_model.................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.09s]
23:59:12.352975 [debug] [Thread-2  ]: Finished running node model.coffee_shop.my_first_dbt_model
23:59:12.353468 [debug] [Thread-4  ]: Began running node model.coffee_shop.my_second_dbt_model
23:59:12.353741 [info ] [Thread-4  ]: 3 of 4 START view model coffee_shop.my_second_dbt_model......................... [RUN]
23:59:12.354810 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop.my_second_dbt_model"
23:59:12.354999 [debug] [Thread-4  ]: Began compiling node model.coffee_shop.my_second_dbt_model
23:59:12.355174 [debug] [Thread-4  ]: Compiling model.coffee_shop.my_second_dbt_model
23:59:12.358470 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
23:59:12.358872 [debug] [Thread-4  ]: finished collecting timing info
23:59:12.359312 [debug] [Thread-4  ]: Began executing node model.coffee_shop.my_second_dbt_model
23:59:12.382193 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop.my_second_dbt_model"
23:59:12.382699 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:59:12.382952 [debug] [Thread-4  ]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id = 1;


23:59:13.172993 [debug] [Thread-4  ]: finished collecting timing info
23:59:13.173538 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cc3eb4f0>]}
23:59:13.173947 [info ] [Thread-4  ]: 3 of 4 OK created view model coffee_shop.my_second_dbt_model.................... [[32mOK[0m in 0.82s]
23:59:13.175547 [debug] [Thread-4  ]: Finished running node model.coffee_shop.my_second_dbt_model
23:59:19.245425 [debug] [Thread-1  ]: finished collecting timing info
23:59:19.245968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cc3addf0>]}
23:59:19.246360 [info ] [Thread-1  ]: 1 of 4 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.99s]
23:59:19.247973 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
23:59:19.248680 [debug] [Thread-6  ]: Began running node model.coffee_shop.monthly_customers
23:59:19.248951 [info ] [Thread-6  ]: 4 of 4 START view model coffee_shop.monthly_customers........................... [RUN]
23:59:19.249954 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
23:59:19.250137 [debug] [Thread-6  ]: Began compiling node model.coffee_shop.monthly_customers
23:59:19.250306 [debug] [Thread-6  ]: Compiling model.coffee_shop.monthly_customers
23:59:19.253779 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
23:59:19.254123 [debug] [Thread-6  ]: finished collecting timing info
23:59:19.254299 [debug] [Thread-6  ]: Began executing node model.coffee_shop.monthly_customers
23:59:19.256938 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
23:59:19.257287 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:59:19.257525 [debug] [Thread-6  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc('month', first_order_at) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


23:59:19.948555 [debug] [Thread-6  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/22691d08-c8bc-4ace-a166-8b3df779030b?maxResults=0&location=US&prettyPrint=false: A valid date part name is required but found first_order_at at [7:25]')
23:59:21.547285 [debug] [Thread-6  ]: finished collecting timing info
23:59:21.547799 [debug] [Thread-6  ]: Database Error in model monthly_customers (models/monthly_customers.sql)
  A valid date part name is required but found first_order_at at [7:25]
  compiled SQL at target/run/coffee_shop/models/monthly_customers.sql
23:59:21.548142 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0477ff-4f8d-48ac-b8cf-24e13e88cc15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cc35acd0>]}
23:59:21.548567 [error] [Thread-6  ]: 4 of 4 ERROR creating view model coffee_shop.monthly_customers.................. [[31mERROR[0m in 2.30s]
23:59:21.551426 [debug] [Thread-6  ]: Finished running node model.coffee_shop.monthly_customers
23:59:21.553059 [debug] [MainThread]: Acquiring new bigquery connection "master"
23:59:21.553481 [info ] [MainThread]: 
23:59:21.553808 [info ] [MainThread]: Finished running 2 table models, 2 view models in 12.26s.
23:59:21.554114 [debug] [MainThread]: Connection 'master' was properly closed.
23:59:21.554279 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
23:59:21.554423 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
23:59:21.554564 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
23:59:21.554713 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
23:59:21.564652 [info ] [MainThread]: 
23:59:21.567093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:59:21.567475 [info ] [MainThread]: 
23:59:21.567767 [error] [MainThread]: [33mDatabase Error in model monthly_customers (models/monthly_customers.sql)[0m
23:59:21.568050 [error] [MainThread]:   A valid date part name is required but found first_order_at at [7:25]
23:59:21.568317 [error] [MainThread]:   compiled SQL at target/run/coffee_shop/models/monthly_customers.sql
23:59:21.568632 [info ] [MainThread]: 
23:59:21.568915 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
23:59:21.571548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ceff32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cef2dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cef2d550>]}


============================== 2022-03-01 00:00:04.399673 | 81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b ==============================
00:00:04.399673 [info ] [MainThread]: Running with dbt=1.0.3
00:00:04.405171 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:00:04.405531 [debug] [MainThread]: Tracking: tracking
00:00:04.428969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813904e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813904e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813904e8b0>]}
00:00:04.491648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:00:04.492198 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/monthly_customers.sql
00:00:04.505948 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
00:00:04.525094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

00:00:04.535117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8138f9cdf0>]}
00:00:04.541450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8138f90dc0>]}
00:00:04.541901 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:00:04.544620 [info ] [MainThread]: 
00:00:04.546129 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:04.547253 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
00:00:04.547572 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:05.355496 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
00:00:05.355933 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:05.527651 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
00:00:05.529486 [info ] [MainThread]: 
00:00:05.537598 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
00:00:05.539380 [info ] [Thread-1  ]: 1 of 4 START table model coffee_shop.customers.................................. [RUN]
00:00:05.537879 [debug] [Thread-2  ]: Began running node model.coffee_shop.my_first_dbt_model
00:00:05.540350 [info ] [Thread-2  ]: 2 of 4 START table model coffee_shop.my_first_dbt_model......................... [RUN]
00:00:05.542247 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
00:00:05.544206 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
00:00:05.543229 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.coffee_shop.my_first_dbt_model"
00:00:05.544864 [debug] [Thread-2  ]: Began compiling node model.coffee_shop.my_first_dbt_model
00:00:05.545043 [debug] [Thread-2  ]: Compiling model.coffee_shop.my_first_dbt_model
00:00:05.544459 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
00:00:05.554419 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
00:00:05.555567 [debug] [Thread-1  ]: finished collecting timing info
00:00:05.555770 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
00:00:05.551040 [debug] [Thread-2  ]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
00:00:05.567359 [debug] [Thread-2  ]: finished collecting timing info
00:00:05.567634 [debug] [Thread-2  ]: Began executing node model.coffee_shop.my_first_dbt_model
00:00:05.598164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:00:05.604822 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:00:05.802577 [debug] [Thread-2  ]: Writing runtime SQL for node "model.coffee_shop.my_first_dbt_model"
00:00:05.803084 [debug] [Thread-2  ]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
00:00:05.805528 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
00:00:05.805927 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
00:00:08.028752 [debug] [Thread-2  ]: finished collecting timing info
00:00:08.029334 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81384d6b20>]}
00:00:08.029787 [info ] [Thread-2  ]: 2 of 4 OK created table model coffee_shop.my_first_dbt_model.................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.49s]
00:00:08.031459 [debug] [Thread-2  ]: Finished running node model.coffee_shop.my_first_dbt_model
00:00:08.031942 [debug] [Thread-4  ]: Began running node model.coffee_shop.my_second_dbt_model
00:00:08.032211 [info ] [Thread-4  ]: 3 of 4 START view model coffee_shop.my_second_dbt_model......................... [RUN]
00:00:08.033330 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.coffee_shop.my_second_dbt_model"
00:00:08.033516 [debug] [Thread-4  ]: Began compiling node model.coffee_shop.my_second_dbt_model
00:00:08.033692 [debug] [Thread-4  ]: Compiling model.coffee_shop.my_second_dbt_model
00:00:08.037167 [debug] [Thread-4  ]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
00:00:08.037552 [debug] [Thread-4  ]: finished collecting timing info
00:00:08.037733 [debug] [Thread-4  ]: Began executing node model.coffee_shop.my_second_dbt_model
00:00:08.060069 [debug] [Thread-4  ]: Writing runtime SQL for node "model.coffee_shop.my_second_dbt_model"
00:00:08.060600 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:00:08.060854 [debug] [Thread-4  ]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id = 1;


00:00:08.859866 [debug] [Thread-4  ]: finished collecting timing info
00:00:08.860414 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81383f27f0>]}
00:00:08.860891 [info ] [Thread-4  ]: 3 of 4 OK created view model coffee_shop.my_second_dbt_model.................... [[32mOK[0m in 0.83s]
00:00:08.862453 [debug] [Thread-4  ]: Finished running node model.coffee_shop.my_second_dbt_model
00:00:13.809695 [debug] [Thread-1  ]: finished collecting timing info
00:00:13.810254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813848b6d0>]}
00:00:13.810642 [info ] [Thread-1  ]: 1 of 4 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.27s]
00:00:13.812294 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
00:00:13.813006 [debug] [Thread-6  ]: Began running node model.coffee_shop.monthly_customers
00:00:13.813287 [info ] [Thread-6  ]: 4 of 4 START view model coffee_shop.monthly_customers........................... [RUN]
00:00:13.814423 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
00:00:13.814606 [debug] [Thread-6  ]: Began compiling node model.coffee_shop.monthly_customers
00:00:13.814775 [debug] [Thread-6  ]: Compiling model.coffee_shop.monthly_customers
00:00:13.818386 [debug] [Thread-6  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
00:00:13.818814 [debug] [Thread-6  ]: finished collecting timing info
00:00:13.818995 [debug] [Thread-6  ]: Began executing node model.coffee_shop.monthly_customers
00:00:13.821847 [debug] [Thread-6  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
00:00:13.822261 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:00:13.822505 [debug] [Thread-6  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


00:00:14.567043 [debug] [Thread-6  ]: finished collecting timing info
00:00:14.567638 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ae7b1c-0fe8-4b57-ab15-d1d83f98c18b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8138457b20>]}
00:00:14.568071 [info ] [Thread-6  ]: 4 of 4 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.75s]
00:00:14.569746 [debug] [Thread-6  ]: Finished running node model.coffee_shop.monthly_customers
00:00:14.571283 [debug] [MainThread]: Acquiring new bigquery connection "master"
00:00:14.571771 [info ] [MainThread]: 
00:00:14.573057 [info ] [MainThread]: Finished running 2 table models, 2 view models in 10.03s.
00:00:14.576358 [debug] [MainThread]: Connection 'master' was properly closed.
00:00:14.577821 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
00:00:14.578019 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
00:00:14.578199 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
00:00:14.578369 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
00:00:14.590253 [info ] [MainThread]: 
00:00:14.591952 [info ] [MainThread]: [32mCompleted successfully[0m
00:00:14.593243 [info ] [MainThread]: 
00:00:14.594356 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
00:00:14.595632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8138f90f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813904e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81383cfee0>]}


============================== 2022-03-01 01:12:07.354600 | 7eaabb2e-155c-465e-9890-777c391a8fa9 ==============================
01:12:07.354600 [info ] [MainThread]: Running with dbt=1.0.3
01:12:07.356950 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
01:12:07.357303 [debug] [MainThread]: Tracking: tracking
01:12:07.381304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca89465310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca89465610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca894655e0>]}
01:12:07.444515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
01:12:07.445033 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/schema.yml
01:12:07.499438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:12:07.508754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eaabb2e-155c-465e-9890-777c391a8fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca89326130>]}
01:12:07.515358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eaabb2e-155c-465e-9890-777c391a8fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca89388f40>]}
01:12:07.515791 [info ] [MainThread]: Found 4 models, 10 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:12:07.518575 [info ] [MainThread]: 
01:12:07.519879 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:12:07.521103 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:12:07.521374 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:12:08.268982 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:12:08.271395 [info ] [MainThread]: 
01:12:08.278358 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:12:08.278653 [info ] [Thread-1  ]: 1 of 10 START test not_null_customers_customer_id............................... [RUN]
01:12:08.279019 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:12:08.279193 [info ] [Thread-2  ]: 2 of 10 START test not_null_monthly_customers_customers......................... [RUN]
01:12:08.279679 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:12:08.279870 [info ] [Thread-3  ]: 3 of 10 START test not_null_monthly_customers_month............................. [RUN]
01:12:08.280390 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
01:12:08.280644 [info ] [Thread-4  ]: 4 of 10 START test not_null_my_first_dbt_model_id............................... [RUN]
01:12:08.280954 [debug] [Thread-5  ]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
01:12:08.281126 [info ] [Thread-5  ]: 5 of 10 START test not_null_my_second_dbt_model_id.............................. [RUN]
01:12:08.281417 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:12:08.281584 [info ] [Thread-6  ]: 6 of 10 START test unique_customers_customer_id................................. [RUN]
01:12:08.281879 [debug] [Thread-7  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:12:08.282044 [info ] [Thread-7  ]: 7 of 10 START test unique_monthly_customers_customers........................... [RUN]
01:12:08.282321 [debug] [Thread-8  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:12:08.282491 [info ] [Thread-8  ]: 8 of 10 START test unique_monthly_customers_month............................... [RUN]
01:12:08.283861 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:12:08.284066 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:12:08.284290 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:12:08.290344 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:12:08.290583 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:12:08.290753 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:12:08.305675 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:12:08.309999 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:12:08.312411 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:12:08.312626 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:12:08.311033 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:12:08.314256 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:12:08.314438 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:12:08.311708 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:12:08.326383 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:12:08.326557 [debug] [Thread-8  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:12:08.310700 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
01:12:08.330664 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
01:12:08.330838 [debug] [Thread-5  ]: Compiling test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
01:12:08.309559 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:12:08.335096 [debug] [Thread-2  ]: finished collecting timing info
01:12:08.335305 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:12:08.311374 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:12:08.341981 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:12:08.342158 [debug] [Thread-7  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:12:08.310354 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
01:12:08.346365 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
01:12:08.346537 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
01:12:08.325782 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:12:08.350725 [debug] [Thread-3  ]: finished collecting timing info
01:12:08.350911 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:12:08.330447 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:12:08.357897 [debug] [Thread-8  ]: finished collecting timing info
01:12:08.358117 [debug] [Thread-8  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:12:08.341747 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:12:08.386130 [debug] [Thread-6  ]: finished collecting timing info
01:12:08.386378 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:12:08.334742 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
01:12:08.407197 [debug] [Thread-5  ]: finished collecting timing info
01:12:08.407398 [debug] [Thread-5  ]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
01:12:08.326169 [debug] [Thread-1  ]: finished collecting timing info
01:12:08.409810 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:12:08.350343 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
01:12:08.413133 [debug] [Thread-4  ]: finished collecting timing info
01:12:08.413315 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
01:12:08.414966 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
01:12:08.415371 [debug] [Thread-4  ]: Opening a new connection, currently in state init
01:12:08.415644 [debug] [Thread-4  ]: On test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
01:12:08.346145 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:12:08.418405 [debug] [Thread-7  ]: finished collecting timing info
01:12:08.418591 [debug] [Thread-7  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:12:08.398148 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:12:08.420870 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
01:12:08.421097 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
01:12:08.418084 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:12:08.423242 [debug] [Thread-6  ]: Opening a new connection, currently in state init
01:12:08.423465 [debug] [Thread-6  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:12:08.409597 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
01:12:08.425344 [debug] [Thread-5  ]: Opening a new connection, currently in state init
01:12:08.425557 [debug] [Thread-5  ]: On test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
01:12:08.406731 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:12:08.427508 [debug] [Thread-3  ]: Opening a new connection, currently in state init
01:12:08.427718 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
01:12:08.403697 [debug] [Thread-8  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:12:08.429324 [debug] [Thread-8  ]: Opening a new connection, currently in state init
01:12:08.429545 [debug] [Thread-8  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:12:08.412779 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:12:08.431457 [debug] [Thread-1  ]: Opening a new connection, currently in state init
01:12:08.431666 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
01:12:08.420425 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:12:08.433697 [debug] [Thread-7  ]: Opening a new connection, currently in state init
01:12:08.433907 [debug] [Thread-7  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:12:09.677640 [debug] [Thread-4  ]: finished collecting timing info
01:12:09.678172 [error] [Thread-4  ]: 4 of 10 FAIL 1 not_null_my_first_dbt_model_id................................... [[31mFAIL 1[0m in 1.37s]
01:12:09.680219 [debug] [Thread-5  ]: finished collecting timing info
01:12:09.680834 [info ] [Thread-5  ]: 5 of 10 PASS not_null_my_second_dbt_model_id.................................... [[32mPASS[0m in 1.37s]
01:12:09.683508 [debug] [Thread-1  ]: finished collecting timing info
01:12:09.683886 [info ] [Thread-1  ]: 1 of 10 PASS not_null_customers_customer_id..................................... [[32mPASS[0m in 1.40s]
01:12:09.684931 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
01:12:09.685182 [debug] [Thread-4  ]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
01:12:09.687647 [info ] [Thread-4  ]: 9 of 10 START test unique_my_first_dbt_model_id................................. [RUN]
01:12:09.686333 [debug] [Thread-5  ]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
01:12:09.688423 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
01:12:09.688695 [info ] [Thread-5  ]: 10 of 10 START test unique_my_second_dbt_model_id............................... [RUN]
01:12:09.687438 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:12:09.692157 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
01:12:09.692352 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
01:12:09.693759 [debug] [Thread-4  ]: Compiling test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
01:12:09.693559 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
01:12:09.698609 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
01:12:09.698781 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
01:12:09.702702 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
01:12:09.703050 [debug] [Thread-5  ]: finished collecting timing info
01:12:09.703230 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
01:12:09.698395 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
01:12:09.705388 [debug] [Thread-4  ]: finished collecting timing info
01:12:09.705567 [debug] [Thread-4  ]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
01:12:09.707444 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
01:12:09.707772 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
01:12:09.708007 [debug] [Thread-4  ]: On test.coffee_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `ae-project-341501`.`coffee_shop`.`my_first_dbt_model`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:12:09.705094 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
01:12:09.711293 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
01:12:09.711509 [debug] [Thread-5  ]: On test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `ae-project-341501`.`coffee_shop`.`my_second_dbt_model`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:12:09.891943 [debug] [Thread-3  ]: finished collecting timing info
01:12:09.892476 [info ] [Thread-3  ]: 3 of 10 PASS not_null_monthly_customers_month................................... [[32mPASS[0m in 1.58s]
01:12:09.893932 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:12:09.914726 [debug] [Thread-7  ]: finished collecting timing info
01:12:09.915193 [info ] [Thread-7  ]: 7 of 10 PASS unique_monthly_customers_customers................................. [[32mPASS[0m in 1.60s]
01:12:09.916511 [debug] [Thread-7  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:12:09.957748 [debug] [Thread-8  ]: finished collecting timing info
01:12:09.958262 [info ] [Thread-8  ]: 8 of 10 PASS unique_monthly_customers_month..................................... [[32mPASS[0m in 1.65s]
01:12:09.959630 [debug] [Thread-8  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:12:10.136906 [debug] [Thread-6  ]: finished collecting timing info
01:12:10.137433 [info ] [Thread-6  ]: 6 of 10 PASS unique_customers_customer_id....................................... [[32mPASS[0m in 1.83s]
01:12:10.138896 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:12:10.151302 [debug] [Thread-2  ]: finished collecting timing info
01:12:10.151828 [info ] [Thread-2  ]: 2 of 10 PASS not_null_monthly_customers_customers............................... [[32mPASS[0m in 1.86s]
01:12:10.153332 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:12:11.239648 [debug] [Thread-5  ]: finished collecting timing info
01:12:11.240178 [info ] [Thread-5  ]: 10 of 10 PASS unique_my_second_dbt_model_id..................................... [[32mPASS[0m in 1.55s]
01:12:11.241743 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
01:12:11.329222 [debug] [Thread-4  ]: finished collecting timing info
01:12:11.329759 [info ] [Thread-4  ]: 9 of 10 PASS unique_my_first_dbt_model_id....................................... [[32mPASS[0m in 1.64s]
01:12:11.331135 [debug] [Thread-4  ]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
01:12:11.332881 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:12:11.333287 [info ] [MainThread]: 
01:12:11.334375 [info ] [MainThread]: Finished running 10 tests in 3.81s.
01:12:11.335550 [debug] [MainThread]: Connection 'master' was properly closed.
01:12:11.335734 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:12:11.335889 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:12:11.336033 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:12:11.336173 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
01:12:11.336311 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
01:12:11.336617 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:12:11.336772 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:12:11.336912 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:12:11.347125 [info ] [MainThread]: 
01:12:11.348428 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
01:12:11.349636 [info ] [MainThread]: 
01:12:11.351288 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
01:12:11.352392 [error] [MainThread]:   Got 1 result, configured to fail if != 0
01:12:11.353623 [info ] [MainThread]: 
01:12:11.354636 [info ] [MainThread]:   compiled SQL at target/compiled/coffee_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
01:12:11.355680 [info ] [MainThread]: 
01:12:11.356701 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
01:12:11.358143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca880eb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca880b0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca880b0670>]}


============================== 2022-03-01 01:23:24.669200 | 49d44e49-1b39-4a8a-9fe5-4b5cbf793a67 ==============================
01:23:24.669200 [info ] [MainThread]: Running with dbt=1.0.3
01:23:24.672926 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
01:23:24.673207 [debug] [MainThread]: Tracking: tracking
01:23:24.693477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0117079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd011707970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd011707610>]}
01:23:24.754986 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
01:23:24.755445 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/my_first_dbt_model.sql
01:23:24.755627 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/my_second_dbt_model.sql
01:23:24.760346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:23:24.770441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d44e49-1b39-4a8a-9fe5-4b5cbf793a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0115f3190>]}
01:23:24.776533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d44e49-1b39-4a8a-9fe5-4b5cbf793a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd011643640>]}
01:23:24.777018 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:23:24.779541 [info ] [MainThread]: 
01:23:24.780813 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:23:24.781881 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:23:24.782153 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:23:25.558553 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:23:25.560100 [info ] [MainThread]: 
01:23:25.565889 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:23:25.566132 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id................................ [RUN]
01:23:25.566485 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:23:25.566660 [info ] [Thread-2  ]: 2 of 6 START test not_null_monthly_customers_customers.......................... [RUN]
01:23:25.567087 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:23:25.567270 [info ] [Thread-3  ]: 3 of 6 START test not_null_monthly_customers_month.............................. [RUN]
01:23:25.567709 [debug] [Thread-4  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:23:25.567896 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id.................................. [RUN]
01:23:25.568214 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:23:25.568391 [info ] [Thread-5  ]: 5 of 6 START test unique_monthly_customers_customers............................ [RUN]
01:23:25.568970 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:23:25.569147 [info ] [Thread-6  ]: 6 of 6 START test unique_monthly_customers_month................................ [RUN]
01:23:25.570046 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:23:25.570247 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:23:25.570480 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:23:25.578148 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:23:25.578341 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:23:25.578514 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:23:25.591187 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:23:25.591838 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:23:25.595998 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:23:25.596184 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:23:25.592887 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:23:25.601238 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:23:25.601411 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:23:25.592184 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:23:25.609731 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:23:25.609922 [debug] [Thread-4  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:23:25.592547 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:23:25.595511 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:23:25.618143 [debug] [Thread-2  ]: finished collecting timing info
01:23:25.618339 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:23:25.601024 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:23:25.624744 [debug] [Thread-3  ]: finished collecting timing info
01:23:25.624943 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:23:25.617807 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:23:25.641846 [debug] [Thread-6  ]: finished collecting timing info
01:23:25.642049 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:23:25.615438 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:23:25.654139 [debug] [Thread-4  ]: finished collecting timing info
01:23:25.654341 [debug] [Thread-4  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:23:25.616486 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:23:25.675174 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:23:25.616277 [debug] [Thread-1  ]: finished collecting timing info
01:23:25.683933 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:23:25.685723 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:23:25.674936 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:23:25.686256 [debug] [Thread-6  ]: Opening a new connection, currently in state init
01:23:25.669269 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:23:25.686929 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
01:23:25.687139 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
01:23:25.669870 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:23:25.688401 [debug] [Thread-4  ]: Opening a new connection, currently in state init
01:23:25.688642 [debug] [Thread-4  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:23:25.686533 [debug] [Thread-6  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:23:25.679366 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:23:25.693461 [debug] [Thread-5  ]: finished collecting timing info
01:23:25.693656 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:23:25.696166 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:23:25.683693 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:23:25.697143 [debug] [Thread-3  ]: Opening a new connection, currently in state init
01:23:25.697360 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
01:23:25.696516 [debug] [Thread-1  ]: Opening a new connection, currently in state init
01:23:25.698196 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
01:23:25.701419 [debug] [Thread-5  ]: Opening a new connection, currently in state init
01:23:25.701645 [debug] [Thread-5  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:23:26.552190 [debug] [Thread-1  ]: finished collecting timing info
01:23:26.552820 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 0.98s]
01:23:26.554262 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:23:26.587231 [debug] [Thread-2  ]: finished collecting timing info
01:23:26.587744 [info ] [Thread-2  ]: 2 of 6 PASS not_null_monthly_customers_customers................................ [[32mPASS[0m in 1.01s]
01:23:26.589175 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:23:26.604989 [debug] [Thread-4  ]: finished collecting timing info
01:23:26.605514 [info ] [Thread-4  ]: 4 of 6 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 1.01s]
01:23:26.607577 [debug] [Thread-3  ]: finished collecting timing info
01:23:26.608143 [info ] [Thread-3  ]: 3 of 6 PASS not_null_monthly_customers_month.................................... [[32mPASS[0m in 1.02s]
01:23:26.609598 [debug] [Thread-4  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:23:26.610703 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:23:26.616888 [debug] [Thread-6  ]: finished collecting timing info
01:23:26.617322 [info ] [Thread-6  ]: 6 of 6 PASS unique_monthly_customers_month...................................... [[32mPASS[0m in 1.02s]
01:23:26.618487 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:23:26.642238 [debug] [Thread-5  ]: finished collecting timing info
01:23:26.642738 [info ] [Thread-5  ]: 5 of 6 PASS unique_monthly_customers_customers.................................. [[32mPASS[0m in 1.05s]
01:23:26.644136 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:23:26.645833 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:23:26.646232 [info ] [MainThread]: 
01:23:26.647276 [info ] [MainThread]: Finished running 6 tests in 1.87s.
01:23:26.648279 [debug] [MainThread]: Connection 'master' was properly closed.
01:23:26.648467 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:23:26.648835 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:23:26.648988 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:23:26.649128 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:23:26.649391 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:23:26.649540 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:23:26.655756 [info ] [MainThread]: 
01:23:26.656993 [info ] [MainThread]: [32mCompleted successfully[0m
01:23:26.658120 [info ] [MainThread]: 
01:23:26.659142 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
01:23:26.660335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0116437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0115f3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0115f3a00>]}


============================== 2022-03-01 01:25:52.460580 | 12d7db58-7321-4e7a-b719-9c05362a5fad ==============================
01:25:52.460580 [info ] [MainThread]: Running with dbt=1.0.3
01:25:52.464996 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
01:25:52.465281 [debug] [MainThread]: Tracking: tracking
01:25:52.483338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e30a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e30640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e308e0>]}
01:25:52.549143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
01:25:52.549816 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
01:25:52.563089 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:25:52.609102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:25:52.618351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d7db58-7321-4e7a-b719-9c05362a5fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388b0bf70>]}
01:25:52.624283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12d7db58-7321-4e7a-b719-9c05362a5fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e13cd0>]}
01:25:52.624678 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:25:52.627046 [info ] [MainThread]: 
01:25:52.628380 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:25:52.629419 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:25:52.629692 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:25:53.495944 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:25:53.497609 [info ] [MainThread]: 
01:25:53.503298 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:25:53.503532 [info ] [Thread-1  ]: 1 of 7 START test not_null_customers_customer_id................................ [RUN]
01:25:53.503910 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:25:53.504096 [info ] [Thread-2  ]: 2 of 7 START test not_null_monthly_customers_customers.......................... [RUN]
01:25:53.504574 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:25:53.504759 [info ] [Thread-3  ]: 3 of 7 START test not_null_monthly_customers_month.............................. [RUN]
01:25:53.505238 [debug] [Thread-4  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:25:53.505432 [info ] [Thread-4  ]: 4 of 7 START test unique_customers_customer_id.................................. [RUN]
01:25:53.505744 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_number_of_orders.cef09e073b
01:25:53.505919 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_number_of_orders............................. [RUN]
01:25:53.506211 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:25:53.506379 [info ] [Thread-6  ]: 6 of 7 START test unique_monthly_customers_customers............................ [RUN]
01:25:53.506667 [debug] [Thread-7  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:25:53.506839 [info ] [Thread-7  ]: 7 of 7 START test unique_monthly_customers_month................................ [RUN]
01:25:53.508035 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:25:53.508232 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:25:53.508451 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:25:53.514178 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:25:53.514370 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:25:53.514532 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:25:53.532640 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:25:53.533508 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:25:53.537897 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:25:53.538075 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:25:53.534530 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:25:53.543889 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:25:53.544063 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:25:53.534871 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:25:53.551947 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:25:53.552124 [debug] [Thread-7  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:25:53.534196 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_number_of_orders.cef09e073b"
01:25:53.557494 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_number_of_orders.cef09e073b
01:25:53.557668 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_number_of_orders.cef09e073b
01:25:53.543674 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:25:53.562144 [debug] [Thread-3  ]: finished collecting timing info
01:25:53.562344 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:25:53.557280 [debug] [Thread-2  ]: finished collecting timing info
01:25:53.568079 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:25:53.537608 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:25:53.584233 [debug] [Thread-1  ]: finished collecting timing info
01:25:53.533855 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:25:53.593770 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:25:53.594000 [debug] [Thread-4  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:25:53.561751 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_number_of_orders.cef09e073b"
01:25:53.598586 [debug] [Thread-5  ]: finished collecting timing info
01:25:53.598770 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_number_of_orders.cef09e073b
01:25:53.584472 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:25:53.615204 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:25:53.551709 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:25:53.615722 [debug] [Thread-6  ]: finished collecting timing info
01:25:53.615918 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:25:53.598203 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:25:53.618116 [debug] [Thread-4  ]: finished collecting timing info
01:25:53.618294 [debug] [Thread-4  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:25:53.556878 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:25:53.621736 [debug] [Thread-7  ]: finished collecting timing info
01:25:53.621914 [debug] [Thread-7  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:25:53.623720 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:25:53.617765 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:25:53.630190 [debug] [Thread-6  ]: Opening a new connection, currently in state init
01:25:53.625889 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_number_of_orders.cef09e073b"
01:25:53.630990 [debug] [Thread-5  ]: Opening a new connection, currently in state init
01:25:53.631199 [debug] [Thread-5  ]: On test.coffee_shop.unique_customers_number_of_orders.cef09e073b: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_number_of_orders.cef09e073b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select number_of_orders as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where number_of_orders is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:25:53.629438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
01:25:53.633050 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
01:25:53.613008 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:25:53.635026 [debug] [Thread-3  ]: Opening a new connection, currently in state init
01:25:53.635243 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
01:25:53.629084 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:25:53.637346 [debug] [Thread-2  ]: Opening a new connection, currently in state init
01:25:53.637562 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
01:25:53.630473 [debug] [Thread-6  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:25:53.629798 [debug] [Thread-7  ]: Opening a new connection, currently in state init
01:25:53.639824 [debug] [Thread-7  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:25:53.621381 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:25:53.641868 [debug] [Thread-4  ]: Opening a new connection, currently in state init
01:25:53.642078 [debug] [Thread-4  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
01:25:54.482274 [debug] [Thread-3  ]: finished collecting timing info
01:25:54.482817 [info ] [Thread-3  ]: 3 of 7 PASS not_null_monthly_customers_month.................................... [[32mPASS[0m in 0.95s]
01:25:54.484393 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:25:54.543638 [debug] [Thread-1  ]: finished collecting timing info
01:25:54.544147 [info ] [Thread-1  ]: 1 of 7 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 1.04s]
01:25:54.545681 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:25:54.547670 [debug] [Thread-7  ]: finished collecting timing info
01:25:54.548229 [info ] [Thread-7  ]: 7 of 7 PASS unique_monthly_customers_month...................................... [[32mPASS[0m in 1.01s]
01:25:54.549466 [debug] [Thread-7  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:25:54.565165 [debug] [Thread-4  ]: finished collecting timing info
01:25:54.567485 [info ] [Thread-4  ]: 4 of 7 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 1.03s]
01:25:54.567068 [debug] [Thread-6  ]: finished collecting timing info
01:25:54.568561 [info ] [Thread-6  ]: 6 of 7 PASS unique_monthly_customers_customers.................................. [[32mPASS[0m in 1.03s]
01:25:54.569365 [debug] [Thread-4  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:25:54.572147 [debug] [Thread-2  ]: finished collecting timing info
01:25:54.572716 [info ] [Thread-2  ]: 2 of 7 PASS not_null_monthly_customers_customers................................ [[32mPASS[0m in 1.06s]
01:25:54.573090 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:25:54.574937 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:25:55.040338 [debug] [Thread-5  ]: finished collecting timing info
01:25:55.040906 [error] [Thread-5  ]: 5 of 7 FAIL 4 unique_customers_number_of_orders................................. [[31mFAIL 4[0m in 1.51s]
01:25:55.042496 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_number_of_orders.cef09e073b
01:25:55.044195 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:25:55.044639 [info ] [MainThread]: 
01:25:55.045849 [info ] [MainThread]: Finished running 7 tests in 2.42s.
01:25:55.047292 [debug] [MainThread]: Connection 'master' was properly closed.
01:25:55.047483 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:25:55.047634 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:25:55.047777 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:25:55.047915 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:25:55.048048 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_number_of_orders.cef09e073b' was properly closed.
01:25:55.048181 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:25:55.048315 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:25:55.054982 [info ] [MainThread]: 
01:25:55.056463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
01:25:55.057737 [info ] [MainThread]: 
01:25:55.058838 [error] [MainThread]: [31mFailure in test unique_customers_number_of_orders (models/schema.yml)[0m
01:25:55.060013 [error] [MainThread]:   Got 4 results, configured to fail if != 0
01:25:55.061301 [info ] [MainThread]: 
01:25:55.062392 [info ] [MainThread]:   compiled SQL at target/compiled/coffee_shop/models/schema.yml/unique_customers_number_of_orders.sql
01:25:55.063533 [info ] [MainThread]: 
01:25:55.064630 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
01:25:55.065958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e13c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e13b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388e13ee0>]}


============================== 2022-03-01 01:40:15.927370 | 869d47fc-9581-4a47-93ef-39de3b39380f ==============================
01:40:15.927370 [info ] [MainThread]: Running with dbt=1.0.3
01:40:15.933186 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:40:15.933489 [debug] [MainThread]: Tracking: tracking
01:40:15.952689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b3c0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b3c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b3c05e0>]}
01:40:16.018136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
01:40:16.018835 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
01:40:16.032178 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:40:16.074353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:40:16.084019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '869d47fc-9581-4a47-93ef-39de3b39380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b07fbe0>]}
01:40:16.089938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '869d47fc-9581-4a47-93ef-39de3b39380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b2e6dc0>]}
01:40:16.090279 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:40:16.092782 [info ] [MainThread]: 
01:40:16.094170 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:40:16.095056 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:40:16.095353 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:40:16.873883 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:40:16.875623 [info ] [MainThread]: 
01:40:16.881337 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:40:16.881803 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:40:16.881992 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:40:16.882205 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:40:16.885737 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:40:16.886176 [debug] [Thread-1  ]: finished collecting timing info
01:40:16.886377 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:40:16.886571 [debug] [Thread-1  ]: finished collecting timing info
01:40:16.886988 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:40:16.887675 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:40:16.888046 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:40:16.888214 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:40:16.888370 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:40:16.891002 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:40:16.891351 [debug] [Thread-3  ]: finished collecting timing info
01:40:16.891529 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:40:16.891698 [debug] [Thread-3  ]: finished collecting timing info
01:40:16.891917 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:40:16.894225 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:40:16.894403 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:40:16.894562 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:40:16.892078 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:40:16.901923 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:40:16.902113 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:40:16.902278 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:40:16.892450 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:40:16.915069 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:40:16.915438 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:40:16.915610 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:40:16.915770 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:40:16.914514 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:40:16.919879 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:40:16.924793 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:40:16.924979 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:40:16.925147 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:40:16.920041 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:40:16.929992 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:40:16.930170 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:40:16.930339 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:40:16.924299 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:40:16.934887 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:40:16.919689 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:40:16.935413 [debug] [Thread-7  ]: finished collecting timing info
01:40:16.935596 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:40:16.935779 [debug] [Thread-7  ]: finished collecting timing info
01:40:16.923241 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:40:16.936512 [debug] [Thread-5  ]: finished collecting timing info
01:40:16.936692 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:40:16.936861 [debug] [Thread-5  ]: finished collecting timing info
01:40:16.934532 [debug] [Thread-4  ]: finished collecting timing info
01:40:16.937420 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:40:16.937600 [debug] [Thread-4  ]: finished collecting timing info
01:40:16.937930 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:40:16.935066 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:40:16.938264 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:40:16.937233 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:40:16.936127 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:40:16.929600 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:40:16.942776 [debug] [Thread-8  ]: finished collecting timing info
01:40:16.942954 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:40:16.943128 [debug] [Thread-8  ]: finished collecting timing info
01:40:16.943505 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:40:16.934177 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:40:16.943929 [debug] [Thread-2  ]: finished collecting timing info
01:40:16.944108 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:40:16.944277 [debug] [Thread-2  ]: finished collecting timing info
01:40:16.944674 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:40:16.942225 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:40:16.945090 [debug] [Thread-1  ]: finished collecting timing info
01:40:16.945264 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:40:16.945430 [debug] [Thread-1  ]: finished collecting timing info
01:40:16.945794 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:40:16.946978 [debug] [MainThread]: Connection 'master' was properly closed.
01:40:16.947162 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:40:16.947311 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:40:16.947485 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:40:16.947622 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:40:16.947754 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:40:16.947885 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:40:16.948016 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:40:16.953661 [info ] [MainThread]: Done.
01:40:16.956648 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:40:16.956836 [info ] [MainThread]: Building catalog
01:40:16.958309 [debug] [MainThread]: Opening a new connection, currently in state init
01:40:17.151558 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:40:17.167683 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:40:17.168042 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:40:19.711204 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:40:19.713121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9b3c0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c98744b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c98744df0>]}
01:40:19.787962 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:40:19.788410 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:41:13.221163 | a49694a0-1d07-41f1-ad30-6b4cf2af6a1b ==============================
01:41:13.221163 [info ] [MainThread]: Running with dbt=1.0.3
01:41:13.225013 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:41:13.225310 [debug] [MainThread]: Tracking: tracking
01:41:13.245750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636426c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636426c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636426c1f0>]}
01:41:13.252627 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:41:13.254257 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:41:13.255557 [info ] [MainThread]: 
01:41:13.256705 [info ] [MainThread]: 
01:41:13.257959 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-01 01:53:21.236614 | b75e72c6-3283-4bee-9918-a79c755fc7a7 ==============================
01:53:21.236614 [info ] [MainThread]: Running with dbt=1.0.3
01:53:21.241077 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
01:53:21.241396 [debug] [MainThread]: Tracking: tracking
01:53:21.265458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9457b7f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9457b7f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9457b7f610>]}
01:53:21.325975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
01:53:21.326434 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customer_doc.md
01:53:21.326903 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
01:53:21.340484 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:53:21.381579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9457b30eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945782c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945782c550>]}


============================== 2022-03-01 01:53:45.381612 | f1412bd4-b3f5-467b-9180-eeb84fa60676 ==============================
01:53:45.381612 [info ] [MainThread]: Running with dbt=1.0.3
01:53:45.385080 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
01:53:45.385410 [debug] [MainThread]: Tracking: tracking
01:53:45.409424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669f8d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669f8d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669f8d670>]}
01:53:45.473420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
01:53:45.473891 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customer_doc.md
01:53:45.474375 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
01:53:45.488690 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:53:45.534368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:53:45.544048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1412bd4-b3f5-467b-9180-eeb84fa60676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669c310a0>]}
01:53:45.550378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1412bd4-b3f5-467b-9180-eeb84fa60676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669e92df0>]}
01:53:45.550828 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:53:45.553322 [info ] [MainThread]: 
01:53:45.554701 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:53:45.555700 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
01:53:45.556026 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:53:46.354755 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:53:46.355175 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:53:46.515892 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:53:46.517353 [info ] [MainThread]: 
01:53:46.523403 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:53:46.523730 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
01:53:46.525100 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:53:46.525294 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:53:46.525516 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:53:46.529041 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:53:46.529441 [debug] [Thread-1  ]: finished collecting timing info
01:53:46.529628 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:53:46.547555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
01:53:46.725586 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
01:53:46.726126 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club.coffee_shop.customers` c 
LEFT JOIN  `analytics-engineers-club.coffee_shop.orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
01:53:54.709634 [debug] [Thread-1  ]: finished collecting timing info
01:53:54.710217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1412bd4-b3f5-467b-9180-eeb84fa60676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd66938f580>]}
01:53:54.710662 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.19s]
01:53:54.712263 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:53:54.713007 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:53:54.713283 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
01:53:54.714512 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:53:54.714698 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:53:54.714872 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:53:54.718392 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:53:54.718837 [debug] [Thread-3  ]: finished collecting timing info
01:53:54.719017 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:53:54.740732 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
01:53:54.741233 [debug] [Thread-3  ]: Opening a new connection, currently in state init
01:53:54.741489 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


01:53:55.503875 [debug] [Thread-3  ]: finished collecting timing info
01:53:55.504415 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1412bd4-b3f5-467b-9180-eeb84fa60676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6682a6460>]}
01:53:55.504836 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.79s]
01:53:55.506313 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:53:55.507727 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:53:55.508117 [info ] [MainThread]: 
01:53:55.509241 [info ] [MainThread]: Finished running 1 table model, 1 view model in 9.95s.
01:53:55.510439 [debug] [MainThread]: Connection 'master' was properly closed.
01:53:55.510620 [debug] [MainThread]: Connection 'list_ae-project-341501' was properly closed.
01:53:55.510776 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
01:53:55.510919 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:53:55.516880 [info ] [MainThread]: 
01:53:55.518139 [info ] [MainThread]: [32mCompleted successfully[0m
01:53:55.519302 [info ] [MainThread]: 
01:53:55.520344 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
01:53:55.521577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669fa52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669fa5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd669f018e0>]}


============================== 2022-03-01 01:54:01.809439 | 21f238fc-4b10-47fa-83d9-9889a447b049 ==============================
01:54:01.809439 [info ] [MainThread]: Running with dbt=1.0.3
01:54:01.813116 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:54:01.813488 [debug] [MainThread]: Tracking: tracking
01:54:01.834222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826b066a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826b065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826b06610>]}
01:54:01.904518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
01:54:01.904798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
01:54:01.905307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:54:01.923787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21f238fc-4b10-47fa-83d9-9889a447b049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826a3f700>]}
01:54:01.930347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21f238fc-4b10-47fa-83d9-9889a447b049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826a961c0>]}
01:54:01.930749 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:54:01.933399 [info ] [MainThread]: 
01:54:01.934920 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:54:01.935855 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:54:01.936152 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:54:02.714859 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:54:02.716481 [info ] [MainThread]: 
01:54:02.722856 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:54:02.723369 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:54:02.723561 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:54:02.723782 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:54:02.727268 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:54:02.727710 [debug] [Thread-1  ]: finished collecting timing info
01:54:02.727904 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:54:02.728107 [debug] [Thread-1  ]: finished collecting timing info
01:54:02.728524 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:54:02.729222 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:54:02.729595 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:54:02.729764 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:54:02.729922 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:54:02.732458 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:54:02.732708 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:02.733305 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:54:02.733474 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:02.733636 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:02.732881 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:02.741967 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:54:02.742168 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:02.742337 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:02.753738 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:54:02.754136 [debug] [Thread-3  ]: finished collecting timing info
01:54:02.754686 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:54:02.754910 [debug] [Thread-3  ]: finished collecting timing info
01:54:02.755302 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:54:02.755795 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:02.756161 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:54:02.756336 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:02.756538 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:02.754413 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:54:02.762446 [debug] [Thread-5  ]: finished collecting timing info
01:54:02.762634 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:02.762819 [debug] [Thread-5  ]: finished collecting timing info
01:54:02.762037 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:02.761859 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:02.764789 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:54:02.764964 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:02.765133 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:02.764017 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:02.769762 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:54:02.769941 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:02.770112 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:02.764384 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:54:02.774567 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:02.774738 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:02.763820 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:02.774377 [debug] [Thread-4  ]: finished collecting timing info
01:54:02.779023 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:02.779220 [debug] [Thread-4  ]: finished collecting timing info
01:54:02.779612 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:02.761635 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:54:02.780126 [debug] [Thread-7  ]: finished collecting timing info
01:54:02.780305 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:02.769370 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:54:02.780851 [debug] [Thread-8  ]: finished collecting timing info
01:54:02.781022 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:02.781188 [debug] [Thread-8  ]: finished collecting timing info
01:54:02.781535 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:02.780477 [debug] [Thread-7  ]: finished collecting timing info
01:54:02.782053 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:02.774030 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:54:02.782473 [debug] [Thread-1  ]: finished collecting timing info
01:54:02.782648 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:02.782818 [debug] [Thread-1  ]: finished collecting timing info
01:54:02.783154 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:02.778717 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:54:02.783601 [debug] [Thread-2  ]: finished collecting timing info
01:54:02.783777 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:02.783946 [debug] [Thread-2  ]: finished collecting timing info
01:54:02.784281 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:02.785559 [debug] [MainThread]: Connection 'master' was properly closed.
01:54:02.785747 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:54:02.785898 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:54:02.786040 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:54:02.786177 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:54:02.786323 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:54:02.786495 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:54:02.786633 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:54:02.792577 [info ] [MainThread]: Done.
01:54:02.798884 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:54:02.799238 [info ] [MainThread]: Building catalog
01:54:02.800975 [debug] [MainThread]: Opening a new connection, currently in state init
01:54:03.001597 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:54:03.018106 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:54:03.018469 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:54:05.294598 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:54:05.296319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8826b066a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88240e6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88240e6460>]}
01:54:05.359481 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:54:05.359944 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:54:12.395284 | f3c3998d-c1cd-456f-a20a-d392991d0f7a ==============================
01:54:12.395284 [info ] [MainThread]: Running with dbt=1.0.3
01:54:12.401217 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:54:12.401554 [debug] [MainThread]: Tracking: tracking
01:54:12.422034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4d9e09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4d9e0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c4d9e0610>]}
01:54:12.428606 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:54:12.430254 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:54:12.431532 [info ] [MainThread]: 
01:54:12.432645 [info ] [MainThread]: 
01:54:12.433725 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-01 01:54:49.619892 | 001fad0a-ef11-42cf-a54a-50020869ee24 ==============================
01:54:49.619892 [info ] [MainThread]: Running with dbt=1.0.3
01:54:49.625869 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:54:49.626171 [debug] [MainThread]: Tracking: tracking
01:54:49.643201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84091109a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84091108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84091108b0>]}
01:54:49.707551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
01:54:49.708288 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customer_doc.md
01:54:49.721429 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
01:54:49.736082 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:54:49.781019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:54:49.790182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '001fad0a-ef11-42cf-a54a-50020869ee24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8408df9070>]}
01:54:49.796144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '001fad0a-ef11-42cf-a54a-50020869ee24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409053f10>]}
01:54:49.796603 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:54:49.798868 [info ] [MainThread]: 
01:54:49.800220 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:54:49.801151 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:54:49.801438 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:54:50.546278 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:54:50.547886 [info ] [MainThread]: 
01:54:50.553629 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:54:50.554095 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:54:50.554284 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:54:50.554501 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:54:50.558053 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:54:50.558489 [debug] [Thread-1  ]: finished collecting timing info
01:54:50.558685 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:54:50.558896 [debug] [Thread-1  ]: finished collecting timing info
01:54:50.559315 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:54:50.559975 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:54:50.560355 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:54:50.560899 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:54:50.561061 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:54:50.564198 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:54:50.560732 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:50.564756 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:54:50.564932 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:50.565093 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:50.560569 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:50.574088 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:54:50.574263 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:50.574425 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:50.573685 [debug] [Thread-3  ]: finished collecting timing info
01:54:50.581572 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:54:50.581762 [debug] [Thread-3  ]: finished collecting timing info
01:54:50.582129 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:54:50.585711 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:54:50.587016 [debug] [Thread-5  ]: finished collecting timing info
01:54:50.586168 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:50.586350 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:50.588194 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:54:50.586515 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:50.588785 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:54:50.588975 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:50.589157 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:50.586665 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:50.594833 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:54:50.595015 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:50.595184 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:50.587808 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:54:50.599309 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:50.599481 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:50.588391 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:50.603548 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:50.607442 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:54:50.587222 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:50.607751 [debug] [Thread-5  ]: finished collecting timing info
01:54:50.608141 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:54:50.581337 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:54:50.608581 [debug] [Thread-4  ]: finished collecting timing info
01:54:50.608778 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:50.594423 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:54:50.609317 [debug] [Thread-2  ]: finished collecting timing info
01:54:50.609515 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:50.609684 [debug] [Thread-2  ]: finished collecting timing info
01:54:50.599099 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:54:50.610475 [debug] [Thread-6  ]: finished collecting timing info
01:54:50.610664 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:50.610835 [debug] [Thread-6  ]: finished collecting timing info
01:54:50.608953 [debug] [Thread-4  ]: finished collecting timing info
01:54:50.611597 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:54:50.610069 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:54:50.611219 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:54:50.603335 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:54:50.612258 [debug] [Thread-7  ]: finished collecting timing info
01:54:50.612446 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:50.612649 [debug] [Thread-7  ]: finished collecting timing info
01:54:50.613037 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:54:50.613409 [debug] [Thread-8  ]: finished collecting timing info
01:54:50.613605 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:50.613772 [debug] [Thread-8  ]: finished collecting timing info
01:54:50.614107 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:54:50.615376 [debug] [MainThread]: Connection 'master' was properly closed.
01:54:50.615567 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:54:50.615718 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
01:54:50.615858 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:54:50.615994 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:54:50.616128 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:54:50.616263 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:54:50.616396 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:54:50.616563 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:54:50.622230 [info ] [MainThread]: Done.
01:54:50.627424 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:54:50.627630 [info ] [MainThread]: Building catalog
01:54:50.629277 [debug] [MainThread]: Opening a new connection, currently in state init
01:54:50.859039 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:54:50.875119 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:54:50.875465 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:54:53.428888 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:54:53.430680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84091109a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409053670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8409053610>]}
01:54:53.494432 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:54:53.494941 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:55:01.725820 | 3793e7ef-8650-444a-989d-52e6a4f080ad ==============================
01:55:01.725820 [info ] [MainThread]: Running with dbt=1.0.3
01:55:01.728982 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:55:01.729386 [debug] [MainThread]: Tracking: tracking
01:55:01.753712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab3e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab3e8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab3e640>]}
01:55:01.760663 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:55:01.762525 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:55:01.763673 [info ] [MainThread]: 
01:55:01.764776 [info ] [MainThread]: 
01:55:01.765850 [info ] [MainThread]: Press Ctrl+C to exit.
01:55:01.767320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab750d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab75130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93cab75190>]}


============================== 2022-03-01 01:55:57.811837 | ff7f617e-337d-46e3-aea0-3813eec74181 ==============================
01:55:57.811837 [info ] [MainThread]: Running with dbt=1.0.3
01:55:57.817826 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:55:57.818108 [debug] [MainThread]: Tracking: tracking
01:55:57.835481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6f057700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6f057610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6f057580>]}
01:55:57.899844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
01:55:57.900651 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customer_doc.md
01:55:57.914019 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
01:55:57.928660 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:55:57.972767 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:55:57.981963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff7f617e-337d-46e3-aea0-3813eec74181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6ed22f10>]}
01:55:57.987861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff7f617e-337d-46e3-aea0-3813eec74181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6ef7adf0>]}
01:55:57.988257 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:55:57.990584 [info ] [MainThread]: 
01:55:57.991923 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:55:57.992833 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:55:57.993119 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:55:58.719433 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:55:58.721071 [info ] [MainThread]: 
01:55:58.726633 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:55:58.727063 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:55:58.727254 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:55:58.727477 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:55:58.730966 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:55:58.731390 [debug] [Thread-1  ]: finished collecting timing info
01:55:58.731588 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:55:58.731785 [debug] [Thread-1  ]: finished collecting timing info
01:55:58.732189 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:55:58.732852 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:55:58.733219 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:55:58.733390 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:55:58.733544 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:55:58.736620 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:55:58.736828 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:55:58.737423 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:55:58.737593 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:55:58.737751 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:55:58.736991 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:55:58.745919 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:55:58.746099 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:55:58.746266 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:55:58.753143 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:55:58.753530 [debug] [Thread-3  ]: finished collecting timing info
01:55:58.758516 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:55:58.758711 [debug] [Thread-3  ]: finished collecting timing info
01:55:58.759110 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:55:58.759617 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:55:58.759988 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:55:58.760160 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:55:58.760318 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:55:58.758199 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:55:58.765413 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:55:58.765584 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:55:58.766916 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:55:58.767096 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:55:58.767259 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:55:58.765742 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:55:58.771832 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:55:58.772012 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:55:58.772179 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:55:58.766525 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:55:58.776668 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:55:58.776840 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:55:58.766048 [debug] [Thread-5  ]: finished collecting timing info
01:55:58.781039 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:55:58.781233 [debug] [Thread-5  ]: finished collecting timing info
01:55:58.781627 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:55:58.776431 [debug] [Thread-4  ]: finished collecting timing info
01:55:58.781864 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:55:58.782043 [debug] [Thread-4  ]: finished collecting timing info
01:55:58.782380 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:55:58.764549 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:55:58.782765 [debug] [Thread-7  ]: finished collecting timing info
01:55:58.782944 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:55:58.783113 [debug] [Thread-7  ]: finished collecting timing info
01:55:58.771407 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:55:58.783913 [debug] [Thread-2  ]: finished collecting timing info
01:55:58.784092 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:55:58.784268 [debug] [Thread-2  ]: finished collecting timing info
01:55:58.784689 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:55:58.783452 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:55:58.776082 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:55:58.785210 [debug] [Thread-1  ]: finished collecting timing info
01:55:58.785388 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:55:58.785556 [debug] [Thread-1  ]: finished collecting timing info
01:55:58.785935 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:55:58.780800 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:55:58.786355 [debug] [Thread-8  ]: finished collecting timing info
01:55:58.786531 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:55:58.786701 [debug] [Thread-8  ]: finished collecting timing info
01:55:58.787073 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:55:58.788278 [debug] [MainThread]: Connection 'master' was properly closed.
01:55:58.788468 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:55:58.788648 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:55:58.788790 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:55:58.788925 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:55:58.789066 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:55:58.789202 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:55:58.789335 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:55:58.795143 [info ] [MainThread]: Done.
01:55:58.801053 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:55:58.801286 [info ] [MainThread]: Building catalog
01:55:58.802993 [debug] [MainThread]: Opening a new connection, currently in state init
01:55:59.014516 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:55:59.030704 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:55:59.031050 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:56:01.282942 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:56:01.286873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6f057700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6dc1ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6dc1ea60>]}
01:56:01.378517 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:56:01.378985 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:56:06.694208 | 2733f26b-33a5-48f4-92fc-6dc8875b2a59 ==============================
01:56:06.694208 [info ] [MainThread]: Running with dbt=1.0.3
01:56:06.697031 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:56:06.697355 [debug] [MainThread]: Tracking: tracking
01:56:06.721298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0438b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0438b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0438b550>]}
01:56:06.725973 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:56:06.727508 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:56:06.728846 [info ] [MainThread]: 
01:56:06.729981 [info ] [MainThread]: 
01:56:06.731142 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-01 01:57:35.637613 | 573eeb5f-0277-4305-8ecd-6dd38f5fedd6 ==============================
01:57:35.637613 [info ] [MainThread]: Running with dbt=1.0.3
01:57:35.640974 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:57:35.641296 [debug] [MainThread]: Tracking: tracking
01:57:35.665190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa9dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa9dd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa9dd580>]}
01:57:35.726073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
01:57:35.726342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
01:57:35.726850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:57:35.737169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573eeb5f-0277-4305-8ecd-6dd38f5fedd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa9186d0>]}
01:57:35.743288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573eeb5f-0277-4305-8ecd-6dd38f5fedd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa903190>]}
01:57:35.743665 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:57:35.745999 [info ] [MainThread]: 
01:57:35.747309 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:57:35.748215 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:57:35.748529 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:57:36.472573 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:57:36.474199 [info ] [MainThread]: 
01:57:36.481910 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:57:36.482346 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:57:36.482545 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:57:36.482766 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:57:36.486189 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:57:36.486613 [debug] [Thread-1  ]: finished collecting timing info
01:57:36.486833 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:57:36.487034 [debug] [Thread-1  ]: finished collecting timing info
01:57:36.487446 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:57:36.488087 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:57:36.488480 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:57:36.488703 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:57:36.488867 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:57:36.491271 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:57:36.491598 [debug] [Thread-3  ]: finished collecting timing info
01:57:36.491775 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:57:36.491945 [debug] [Thread-3  ]: finished collecting timing info
01:57:36.492158 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:57:36.493074 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:57:36.493243 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:57:36.493399 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:57:36.492315 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:57:36.502057 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:57:36.502242 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:57:36.502407 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:57:36.492708 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:57:36.509234 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:57:36.513155 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:57:36.514078 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:57:36.514253 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:57:36.514418 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:57:36.513636 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:57:36.518643 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:57:36.518829 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:57:36.518999 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:57:36.513485 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:57:36.523164 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:57:36.523367 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:57:36.523531 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:57:36.513326 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:57:36.528040 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:57:36.512706 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:57:36.528581 [debug] [Thread-4  ]: finished collecting timing info
01:57:36.528764 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:57:36.528949 [debug] [Thread-4  ]: finished collecting timing info
01:57:36.518250 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:57:36.529653 [debug] [Thread-7  ]: finished collecting timing info
01:57:36.529834 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:57:36.530006 [debug] [Thread-7  ]: finished collecting timing info
01:57:36.527661 [debug] [Thread-5  ]: finished collecting timing info
01:57:36.530570 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:57:36.530747 [debug] [Thread-5  ]: finished collecting timing info
01:57:36.531082 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:57:36.528213 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:57:36.531416 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:57:36.530380 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:57:36.529339 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:57:36.522772 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:57:36.535793 [debug] [Thread-1  ]: finished collecting timing info
01:57:36.535980 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:57:36.536156 [debug] [Thread-1  ]: finished collecting timing info
01:57:36.536547 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:57:36.527331 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:57:36.536970 [debug] [Thread-2  ]: finished collecting timing info
01:57:36.537147 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:57:36.537324 [debug] [Thread-2  ]: finished collecting timing info
01:57:36.537686 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:57:36.535270 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:57:36.538096 [debug] [Thread-8  ]: finished collecting timing info
01:57:36.538275 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:57:36.538446 [debug] [Thread-8  ]: finished collecting timing info
01:57:36.538817 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:57:36.540014 [debug] [MainThread]: Connection 'master' was properly closed.
01:57:36.540198 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:57:36.540347 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:57:36.540513 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:57:36.540660 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:57:36.540795 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:57:36.540928 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:57:36.541059 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:57:36.546543 [info ] [MainThread]: Done.
01:57:36.551596 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:57:36.551803 [info ] [MainThread]: Building catalog
01:57:36.553591 [debug] [MainThread]: Opening a new connection, currently in state init
01:57:36.745106 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:57:36.761205 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:57:36.761557 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:57:39.005600 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:57:39.007392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaa9dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec90fb2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec90fb2cd0>]}
01:57:39.070131 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:57:39.070592 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:57:44.145874 | 8948d148-f785-41c7-a5c7-425703cf3fa8 ==============================
01:57:44.145874 [info ] [MainThread]: Running with dbt=1.0.3
01:57:44.149710 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:57:44.150010 [debug] [MainThread]: Tracking: tracking
01:57:44.170564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf9e5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf9e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf9e5910>]}
01:57:44.184589 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:57:44.186497 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:57:44.187482 [info ] [MainThread]: 
01:57:44.188448 [info ] [MainThread]: 
01:57:44.189721 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-01 01:58:06.697345 | 0dc965d6-4018-4200-bbd7-d8c635575914 ==============================
01:58:06.697345 [info ] [MainThread]: Running with dbt=1.0.3
01:58:06.701019 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
01:58:06.701314 [debug] [MainThread]: Tracking: tracking
01:58:06.721739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc039aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc039a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc039a6a0>]}
01:58:06.785567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
01:58:06.786339 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customer_doc.md
01:58:06.800483 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
01:58:06.815483 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
01:58:06.861219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

01:58:06.870825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dc965d6-4018-4200-bbd7-d8c635575914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0080130>]}
01:58:06.877032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dc965d6-4018-4200-bbd7-d8c635575914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc02daf10>]}
01:58:06.877450 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
01:58:06.879950 [info ] [MainThread]: 
01:58:06.881373 [debug] [MainThread]: Acquiring new bigquery connection "master"
01:58:06.882290 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
01:58:06.882571 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:58:07.686505 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
01:58:07.688113 [info ] [MainThread]: 
01:58:07.693765 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
01:58:07.694245 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
01:58:07.694433 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
01:58:07.694645 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
01:58:07.698170 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
01:58:07.698649 [debug] [Thread-1  ]: finished collecting timing info
01:58:07.698863 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
01:58:07.699087 [debug] [Thread-1  ]: finished collecting timing info
01:58:07.699558 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
01:58:07.700221 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
01:58:07.700638 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
01:58:07.700818 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
01:58:07.700973 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
01:58:07.704167 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
01:58:07.704557 [debug] [Thread-3  ]: finished collecting timing info
01:58:07.704746 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:58:07.704906 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:58:07.705981 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:58:07.706151 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:58:07.706307 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:58:07.705497 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:58:07.714136 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:58:07.714354 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:58:07.705089 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
01:58:07.726552 [debug] [Thread-3  ]: finished collecting timing info
01:58:07.726980 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
01:58:07.727470 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:58:07.727835 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:58:07.728005 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:58:07.728169 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:58:07.726218 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
01:58:07.737514 [debug] [Thread-5  ]: finished collecting timing info
01:58:07.737698 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:58:07.737886 [debug] [Thread-5  ]: finished collecting timing info
01:58:07.735529 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:58:07.738695 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:58:07.738873 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:58:07.739034 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:58:07.737099 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:58:07.743596 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:58:07.743774 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:58:07.743938 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:58:07.735364 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:58:07.748289 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:58:07.738329 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
01:58:07.735123 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
01:58:07.748941 [debug] [Thread-7  ]: finished collecting timing info
01:58:07.749129 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:58:07.749305 [debug] [Thread-7  ]: finished collecting timing info
01:58:07.736919 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
01:58:07.750105 [debug] [Thread-4  ]: finished collecting timing info
01:58:07.750284 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:58:07.750451 [debug] [Thread-4  ]: finished collecting timing info
01:58:07.750822 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
01:58:07.748464 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:58:07.751116 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:58:07.749654 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
01:58:07.743192 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
01:58:07.755617 [debug] [Thread-2  ]: finished collecting timing info
01:58:07.755800 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:58:07.755971 [debug] [Thread-2  ]: finished collecting timing info
01:58:07.756355 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
01:58:07.747881 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
01:58:07.756868 [debug] [Thread-1  ]: finished collecting timing info
01:58:07.757049 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:58:07.757221 [debug] [Thread-1  ]: finished collecting timing info
01:58:07.757555 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
01:58:07.755195 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
01:58:07.757993 [debug] [Thread-8  ]: finished collecting timing info
01:58:07.758166 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:58:07.758332 [debug] [Thread-8  ]: finished collecting timing info
01:58:07.758694 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
01:58:07.759905 [debug] [MainThread]: Connection 'master' was properly closed.
01:58:07.760088 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
01:58:07.760235 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
01:58:07.760374 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
01:58:07.760568 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
01:58:07.760719 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
01:58:07.760853 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
01:58:07.760985 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
01:58:07.766630 [info ] [MainThread]: Done.
01:58:07.772020 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
01:58:07.772253 [info ] [MainThread]: Building catalog
01:58:07.774012 [debug] [MainThread]: Opening a new connection, currently in state init
01:58:07.960608 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
01:58:07.976935 [debug] [ThreadPool]: Opening a new connection, currently in state init
01:58:07.977296 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
01:58:10.191693 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
01:58:10.193526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc039aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb8707e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcb8707d00>]}
01:58:10.257401 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
01:58:10.257855 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.


============================== 2022-03-01 01:58:15.169410 | 1bc28ae1-4834-4a94-8936-8d0f6642e281 ==============================
01:58:15.169410 [info ] [MainThread]: Running with dbt=1.0.3
01:58:15.172964 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:58:15.173244 [debug] [MainThread]: Tracking: tracking
01:58:15.193674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb11220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb11580>]}
01:58:15.200614 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:58:15.202071 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:58:15.203309 [info ] [MainThread]: 
01:58:15.204405 [info ] [MainThread]: 
01:58:15.206215 [info ] [MainThread]: Press Ctrl+C to exit.
01:58:15.209183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb11bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb32070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9eb320d0>]}


============================== 2022-03-01 01:58:31.484091 | b6d46a22-7aa9-45dc-b483-c024e0c606f2 ==============================
01:58:31.484091 [info ] [MainThread]: Running with dbt=1.0.3
01:58:31.489070 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:58:31.489369 [debug] [MainThread]: Tracking: tracking
01:58:31.512540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67845aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67845a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd67845a910>]}
01:58:31.517516 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:58:31.519134 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:58:31.520241 [info ] [MainThread]: 
01:58:31.521387 [info ] [MainThread]: 
01:58:31.522482 [info ] [MainThread]: Press Ctrl+C to exit.
01:58:31.523826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd678413040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6784130a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd678413100>]}


============================== 2022-03-01 02:12:23.620364 | 1ce15c91-ab28-42bf-ad29-d70139d70b92 ==============================
02:12:23.620364 [info ] [MainThread]: Running with dbt=1.0.3
02:12:23.625144 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:12:23.625491 [debug] [MainThread]: Tracking: tracking
02:12:23.649113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7684b06a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7684b05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7684b0610>]}
02:12:23.698499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7684a4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7683d5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7683d52e0>]}


============================== 2022-03-01 02:13:32.852586 | 66534251-465f-4eec-9c72-dd44140156cc ==============================
02:13:32.852586 [info ] [MainThread]: Running with dbt=1.0.3
02:13:32.856951 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:13:32.857247 [debug] [MainThread]: Tracking: tracking
02:13:32.876371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5f53700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5f53610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5f53580>]}
02:13:32.925320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5f46370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5e773d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1e5e772b0>]}


============================== 2022-03-01 02:15:10.626048 | ba043078-49e0-452f-84fb-c13728cac989 ==============================
02:15:10.626048 [info ] [MainThread]: Running with dbt=1.0.3
02:15:10.628985 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:15:10.629305 [debug] [MainThread]: Tracking: tracking
02:15:10.653363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89f649a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89f646a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89f64910>]}
02:15:10.715163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
02:15:10.715673 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/sources.yml
02:15:10.716070 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
02:15:10.716398 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customer_doc.md
02:15:10.729796 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:15:10.788033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:15:10.797172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba043078-49e0-452f-84fb-c13728cac989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89c50dc0>]}
02:15:10.803346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba043078-49e0-452f-84fb-c13728cac989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89eaafd0>]}
02:15:10.803690 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:15:10.806073 [info ] [MainThread]: 
02:15:10.807351 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:10.808360 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:15:10.808698 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:11.578805 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:15:11.579243 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:11.768192 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:15:11.769750 [info ] [MainThread]: 
02:15:11.775143 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:15:11.775475 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:15:11.776885 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:15:11.777081 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:15:11.777304 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:15:11.782916 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:15:11.783323 [debug] [Thread-1  ]: finished collecting timing info
02:15:11.783515 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:15:11.799806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:15:12.039286 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:15:12.039866 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `ae-project-341501`.`coffee_shop`.`customers` c 
LEFT JOIN  `ae-project-341501`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:15:12.318880 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `ae-project-341501`.`coffee_shop`.`customers` c 
LEFT JOIN  `ae-project-341501`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:15:12.319155 [debug] [Thread-1  ]: BigQuery adapter: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/82fe3649-60c6-4ef7-ba58-4c2a0929c0d6?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.orders was not found in location US

(job ID: 82fe3649-60c6-4ef7-ba58-4c2a0929c0d6)

                                                        -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */
   2:
   3:
   4:  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:SELECT c.id as customer_id, 
  12:        c.name, 
  13:        c.email,  
  14:        min(o.created_at) as first_order_at, 
  15:        count(distinct o.id) as number_of_orders
  16:FROM `ae-project-341501`.`coffee_shop`.`customers` c 
  17:LEFT JOIN  `ae-project-341501`.`coffee_shop`.`orders` o on c.id = o.customer_id
  18:GROUP BY 1, 2, 3
  19:ORDER BY first_order_at
  20:  );
  21:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
02:15:12.319505 [debug] [Thread-1  ]: finished collecting timing info
02:15:12.319944 [debug] [Thread-1  ]: Runtime Error in model customers (models/customers.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/82fe3649-60c6-4ef7-ba58-4c2a0929c0d6?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.orders was not found in location US
  
  (job ID: 82fe3649-60c6-4ef7-ba58-4c2a0929c0d6)
02:15:12.320303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba043078-49e0-452f-84fb-c13728cac989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda883211c0>]}
02:15:12.320772 [error] [Thread-1  ]: 1 of 2 ERROR creating table model coffee_shop.customers......................... [[31mERROR[0m in 0.54s]
02:15:12.322280 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:15:12.323104 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:15:12.323322 [info ] [Thread-3  ]: 2 of 2 SKIP relation coffee_shop.monthly_customers.............................. [[33mSKIP[0m]
02:15:12.324360 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:15:12.325872 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:12.326288 [info ] [MainThread]: 
02:15:12.327469 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.52s.
02:15:12.328728 [debug] [MainThread]: Connection 'master' was properly closed.
02:15:12.328917 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:15:12.329072 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:15:12.335112 [info ] [MainThread]: 
02:15:12.336273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:15:12.337514 [info ] [MainThread]: 
02:15:12.338582 [error] [MainThread]: [33mRuntime Error in model customers (models/customers.sql)[0m
02:15:12.341088 [error] [MainThread]:   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/82fe3649-60c6-4ef7-ba58-4c2a0929c0d6?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.orders was not found in location US
02:15:12.342195 [error] [MainThread]:   
02:15:12.343205 [error] [MainThread]:   (job ID: 82fe3649-60c6-4ef7-ba58-4c2a0929c0d6)
02:15:12.344264 [info ] [MainThread]: 
02:15:12.353608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
02:15:12.355003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89e96b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89ea1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda89eaaa60>]}


============================== 2022-03-01 02:15:27.791745 | b9915fb9-ba71-4daa-8568-293487a0847d ==============================
02:15:27.791745 [info ] [MainThread]: Running with dbt=1.0.3
02:15:27.797674 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:15:27.797972 [debug] [MainThread]: Tracking: tracking
02:15:27.815048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbed0e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbed0e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbed0e610>]}
02:15:27.878893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:15:27.879640 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:15:27.879826 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:15:27.880004 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:15:27.893536 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:15:27.908409 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:15:27.958614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbec4a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbec51d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbec511f0>]}


============================== 2022-03-01 02:15:46.330426 | e9a5fa3c-4fa2-48e7-842a-6dfad13cd686 ==============================
02:15:46.330426 [info ] [MainThread]: Running with dbt=1.0.3
02:15:46.332977 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:15:46.333308 [debug] [MainThread]: Tracking: tracking
02:15:46.357502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8c149d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8c14970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8c14550>]}
02:15:46.421129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:15:46.421937 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:15:46.422119 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:15:46.422298 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:15:46.422547 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
02:15:46.436011 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:15:46.451206 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:15:46.508718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:15:46.518383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9a5fa3c-4fa2-48e7-842a-6dfad13cd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea88fe160>]}
02:15:46.524827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9a5fa3c-4fa2-48e7-842a-6dfad13cd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8b5cc70>]}
02:15:46.525244 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:15:46.527648 [info ] [MainThread]: 
02:15:46.529015 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:46.529968 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:15:46.530282 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:47.289092 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:15:47.289512 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:47.500012 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:15:47.500774 [info ] [MainThread]: 
02:15:47.507147 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:15:47.507508 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:15:47.508947 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:15:47.509138 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:15:47.509363 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:15:47.513701 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:15:47.514111 [debug] [Thread-1  ]: finished collecting timing info
02:15:47.514301 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:15:47.530994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:15:47.713767 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:15:47.714318 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `ae-project-341501`.`coffee_shop`.`customers` c 
LEFT JOIN  `ae-project-341501`.`coffee_shop`.`order` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:15:48.030035 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `ae-project-341501`.`coffee_shop`.`customers` c 
LEFT JOIN  `ae-project-341501`.`coffee_shop`.`order` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:15:48.030312 [debug] [Thread-1  ]: BigQuery adapter: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/8125371e-01c6-4acf-bbe1-67f667bbc47b?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.order was not found in location US

(job ID: 8125371e-01c6-4acf-bbe1-67f667bbc47b)

                                                        -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */
   2:
   3:
   4:  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:SELECT c.id as customer_id, 
  12:        c.name, 
  13:        c.email,  
  14:        min(o.created_at) as first_order_at, 
  15:        count(distinct o.id) as number_of_orders
  16:FROM `ae-project-341501`.`coffee_shop`.`customers` c 
  17:LEFT JOIN  `ae-project-341501`.`coffee_shop`.`order` o on c.id = o.customer_id
  18:GROUP BY 1, 2, 3
  19:ORDER BY first_order_at
  20:  );
  21:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
02:15:48.030682 [debug] [Thread-1  ]: finished collecting timing info
02:15:48.031106 [debug] [Thread-1  ]: Runtime Error in model customers (models/customers.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/8125371e-01c6-4acf-bbe1-67f667bbc47b?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.order was not found in location US
  
  (job ID: 8125371e-01c6-4acf-bbe1-67f667bbc47b)
02:15:48.031477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a5fa3c-4fa2-48e7-842a-6dfad13cd686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea07b2a00>]}
02:15:48.031934 [error] [Thread-1  ]: 1 of 2 ERROR creating table model coffee_shop.customers......................... [[31mERROR[0m in 0.52s]
02:15:48.033448 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:15:48.034290 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:15:48.034502 [info ] [Thread-3  ]: 2 of 2 SKIP relation coffee_shop.monthly_customers.............................. [[33mSKIP[0m]
02:15:48.036109 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:15:48.040203 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:15:48.040880 [info ] [MainThread]: 
02:15:48.041442 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.51s.
02:15:48.042174 [debug] [MainThread]: Connection 'master' was properly closed.
02:15:48.042360 [debug] [MainThread]: Connection 'list_ae-project-341501' was properly closed.
02:15:48.042510 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:15:48.050995 [info ] [MainThread]: 
02:15:48.052405 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:15:48.053547 [info ] [MainThread]: 
02:15:48.054577 [error] [MainThread]: [33mRuntime Error in model customers (models/customers.sql)[0m
02:15:48.055602 [error] [MainThread]:   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/8125371e-01c6-4acf-bbe1-67f667bbc47b?maxResults=0&location=US&prettyPrint=false: Not found: Table ae-project-341501:coffee_shop.order was not found in location US
02:15:48.056824 [error] [MainThread]:   
02:15:48.058475 [error] [MainThread]:   (job ID: 8125371e-01c6-4acf-bbe1-67f667bbc47b)
02:15:48.059510 [info ] [MainThread]: 
02:15:48.061894 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
02:15:48.063165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea8b73ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea88f3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea88f3df0>]}


============================== 2022-03-01 02:18:11.226776 | 069d73f3-b904-49d6-81b2-d6069c7509bb ==============================
02:18:11.226776 [info ] [MainThread]: Running with dbt=1.0.3
02:18:11.232554 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:18:11.232952 [debug] [MainThread]: Tracking: tracking
02:18:11.252064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14866a59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14866a5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14866a5670>]}
02:18:11.301537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14866c1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14865ada30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14865ad910>]}


============================== 2022-03-01 02:19:47.665579 | dc6b28b6-ba67-4ed3-9192-378f66394bba ==============================
02:19:47.665579 [info ] [MainThread]: Running with dbt=1.0.3
02:19:47.668940 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:19:47.669237 [debug] [MainThread]: Tracking: tracking
02:19:47.694310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667f49a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667f49640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667f498e0>]}
02:19:47.754824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:19:47.755579 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:19:47.755762 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.order
02:19:47.755950 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:19:47.756202 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
02:19:47.769416 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:19:47.784278 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:19:47.834998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667ea7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667ea75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667ea7b20>]}


============================== 2022-03-01 02:21:33.501576 | 93fe6201-c86f-4c6e-928f-16e1dec11a20 ==============================
02:21:33.501576 [info ] [MainThread]: Running with dbt=1.0.3
02:21:33.504941 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:21:33.505215 [debug] [MainThread]: Tracking: tracking
02:21:33.525872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833b2be310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833b2be610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833b2be5e0>]}
02:21:33.587934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:21:33.588719 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:21:33.588902 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.order
02:21:33.589079 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:21:33.589323 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
02:21:33.602378 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:21:33.617020 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:21:33.672645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:21:33.681829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93fe6201-c86f-4c6e-928f-16e1dec11a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833af881f0>]}
02:21:33.687827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93fe6201-c86f-4c6e-928f-16e1dec11a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833b1e4b50>]}
02:21:33.688166 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:21:33.690343 [info ] [MainThread]: 
02:21:33.691626 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:21:33.692557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:21:33.692863 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:34.460992 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:21:34.461412 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:34.628568 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:21:34.630084 [info ] [MainThread]: 
02:21:34.637929 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:21:34.638271 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:21:34.639646 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:21:34.639864 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:21:34.640088 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:21:34.644439 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:21:34.644882 [debug] [Thread-1  ]: finished collecting timing info
02:21:34.645080 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:21:34.661842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:21:34.835013 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:21:34.835557 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:21:42.005830 [debug] [Thread-1  ]: finished collecting timing info
02:21:42.006434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93fe6201-c86f-4c6e-928f-16e1dec11a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833869ceb0>]}
02:21:42.006888 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 7.37s]
02:21:42.008471 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:21:42.009217 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:21:42.009512 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:21:42.011141 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:21:42.011326 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:21:42.011514 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:21:42.014518 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:21:42.014935 [debug] [Thread-3  ]: finished collecting timing info
02:21:42.015119 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:21:42.037761 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:21:42.038304 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:21:42.038561 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:21:42.801357 [debug] [Thread-3  ]: finished collecting timing info
02:21:42.801919 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93fe6201-c86f-4c6e-928f-16e1dec11a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83386492b0>]}
02:21:42.802316 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.79s]
02:21:42.803845 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:21:42.805331 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:21:42.805723 [info ] [MainThread]: 
02:21:42.807373 [info ] [MainThread]: Finished running 1 table model, 1 view model in 9.11s.
02:21:42.808545 [debug] [MainThread]: Connection 'master' was properly closed.
02:21:42.808727 [debug] [MainThread]: Connection 'list_ae-project-341501' was properly closed.
02:21:42.808876 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:21:42.809016 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:21:42.815626 [info ] [MainThread]: 
02:21:42.816895 [info ] [MainThread]: [32mCompleted successfully[0m
02:21:42.818028 [info ] [MainThread]: 
02:21:42.819069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:21:42.820208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833b1e4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833af4df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833af4df40>]}


============================== 2022-03-01 02:21:49.496243 | 4b356238-6d21-4afe-8317-622afae74193 ==============================
02:21:49.496243 [info ] [MainThread]: Running with dbt=1.0.3
02:21:49.501014 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
02:21:49.501330 [debug] [MainThread]: Tracking: tracking
02:21:49.522500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44eef790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44eef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44eef670>]}
02:21:49.585174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:21:49.585447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:21:49.585974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:21:49.596405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b356238-6d21-4afe-8317-622afae74193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44e4cdf0>]}
02:21:49.602832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b356238-6d21-4afe-8317-622afae74193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44eceb50>]}
02:21:49.603273 [info ] [MainThread]: Found 2 models, 6 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:21:49.605797 [info ] [MainThread]: 
02:21:49.607100 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:21:49.608021 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:21:49.608308 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:50.360564 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:21:50.362166 [info ] [MainThread]: 
02:21:50.368596 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:21:50.369063 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:21:50.369259 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:21:50.369484 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:21:50.373826 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:21:50.374259 [debug] [Thread-1  ]: finished collecting timing info
02:21:50.374453 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:21:50.374657 [debug] [Thread-1  ]: finished collecting timing info
02:21:50.375078 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:21:50.375713 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:21:50.376087 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:21:50.376255 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:21:50.376411 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:21:50.378825 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:21:50.379148 [debug] [Thread-3  ]: finished collecting timing info
02:21:50.379323 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:21:50.379493 [debug] [Thread-3  ]: finished collecting timing info
02:21:50.379886 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:21:50.380079 [debug] [Thread-4  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:21:50.380240 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:21:50.381757 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:21:50.381934 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:21:50.382226 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:21:50.381400 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:21:50.389970 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:21:50.390159 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:21:50.390326 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:21:50.381238 [debug] [Thread-8  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:21:50.402474 [debug] [Thread-8  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:21:50.402654 [debug] [Thread-8  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:21:50.402818 [debug] [Thread-8  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:21:50.381072 [debug] [Thread-7  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:21:50.409924 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:21:50.410115 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:21:50.410283 [debug] [Thread-7  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:21:50.380692 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:21:50.415485 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:21:50.415657 [debug] [Thread-4  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:21:50.402066 [debug] [Thread-1  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:21:50.419829 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:21:50.420011 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:21:50.420177 [debug] [Thread-1  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:21:50.424031 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:21:50.401847 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:21:50.424794 [debug] [Thread-5  ]: finished collecting timing info
02:21:50.425139 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:21:50.414115 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:21:50.425652 [debug] [Thread-7  ]: finished collecting timing info
02:21:50.425825 [debug] [Thread-7  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:21:50.426001 [debug] [Thread-7  ]: finished collecting timing info
02:21:50.415278 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:21:50.426730 [debug] [Thread-2  ]: finished collecting timing info
02:21:50.426909 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:21:50.409600 [debug] [Thread-8  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:21:50.427424 [debug] [Thread-8  ]: finished collecting timing info
02:21:50.427592 [debug] [Thread-8  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:21:50.427760 [debug] [Thread-8  ]: finished collecting timing info
02:21:50.427091 [debug] [Thread-2  ]: finished collecting timing info
02:21:50.425323 [debug] [Thread-5  ]: finished collecting timing info
02:21:50.428918 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:21:50.419443 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:21:50.429395 [debug] [Thread-4  ]: finished collecting timing info
02:21:50.429576 [debug] [Thread-4  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:21:50.426406 [debug] [Thread-7  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:21:50.428543 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:21:50.428138 [debug] [Thread-8  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:21:50.429753 [debug] [Thread-4  ]: finished collecting timing info
02:21:50.430473 [debug] [Thread-4  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:21:50.424425 [debug] [Thread-1  ]: finished collecting timing info
02:21:50.430764 [debug] [Thread-1  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:21:50.430941 [debug] [Thread-1  ]: finished collecting timing info
02:21:50.431284 [debug] [Thread-1  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:21:50.432476 [debug] [MainThread]: Connection 'master' was properly closed.
02:21:50.432691 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
02:21:50.432846 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
02:21:50.432987 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:21:50.433125 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:21:50.433261 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:21:50.433398 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
02:21:50.433532 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
02:21:50.439373 [info ] [MainThread]: Done.
02:21:50.444880 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
02:21:50.445090 [info ] [MainThread]: Building catalog
02:21:50.446981 [debug] [MainThread]: Opening a new connection, currently in state init
02:21:50.808675 [debug] [ThreadPool]: Acquiring new bigquery connection "ae-project-341501.information_schema"
02:21:50.818061 [debug] [ThreadPool]: Acquiring new bigquery connection "analytics-engineers-club.information_schema"
02:21:50.833582 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:50.834349 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:50.834849 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:21:50.834641 [debug] [ThreadPool]: On ae-project-341501.information_schema: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "connection_name": "ae-project-341501.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `ae-project-341501`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `ae-project-341501`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
02:21:53.158509 [info ] [MainThread]: Catalog written to /home/ubuntu/coffee_shop_dbt/aec-hannah-dbt/target/catalog.json
02:21:53.160238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44eef790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f444dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f444dc0a0>]}
02:21:53.222416 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:21:53.222877 [debug] [MainThread]: Connection 'ae-project-341501.information_schema' was properly closed.
02:21:53.223031 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2022-03-01 02:22:29.169689 | dcf81cd1-cbc8-4337-972a-1ba82e7a29ac ==============================
02:22:29.169689 [info ] [MainThread]: Running with dbt=1.0.3
02:22:29.172986 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
02:22:29.173265 [debug] [MainThread]: Tracking: tracking
02:22:29.197128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d42ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d42e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d42e8b0>]}
02:22:29.201621 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:22:29.203151 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:22:29.204429 [info ] [MainThread]: 
02:22:29.205541 [info ] [MainThread]: 
02:22:29.206630 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-03-01 02:26:04.730073 | e36f028c-232d-4669-a50a-a870dbc61e19 ==============================
02:26:04.730073 [info ] [MainThread]: Running with dbt=1.0.3
02:26:04.732945 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:26:04.733244 [debug] [MainThread]: Tracking: tracking
02:26:04.757503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47238a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f472389d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f472385e0>]}
02:26:04.818177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:26:04.818938 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:26:04.819117 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:26:04.819304 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:26:04.832578 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:26:04.847480 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:26:04.899289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47151130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47151790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47151a00>]}


============================== 2022-03-01 02:27:08.592621 | b9b045a8-237a-4957-bc17-39d16bdcfb55 ==============================
02:27:08.592621 [info ] [MainThread]: Running with dbt=1.0.3
02:27:08.597006 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:27:08.597304 [debug] [MainThread]: Tracking: tracking
02:27:08.620607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607f769a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607f768e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607f768b0>]}
02:27:08.681924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:27:08.682717 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:27:08.682902 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:27:08.683082 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:27:08.696423 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:27:08.711727 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:27:08.763687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607be3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607be3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7607e922e0>]}


============================== 2022-03-01 02:27:16.323562 | d4bdbc33-9067-4a90-98b7-83ffb8179a68 ==============================
02:27:16.323562 [info ] [MainThread]: Running with dbt=1.0.3
02:27:16.329015 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:27:16.329295 [debug] [MainThread]: Tracking: tracking
02:27:16.348401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807d0be6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807d0be5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807d0be610>]}
02:27:16.409692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:27:16.410410 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:27:16.410589 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:27:16.410765 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:27:16.423630 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:27:16.438378 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:27:16.488526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cffa070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cffae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807cffaaf0>]}


============================== 2022-03-01 02:27:30.629233 | 2117389f-e6c1-4816-bc2c-19ff863ea294 ==============================
02:27:30.629233 [info ] [MainThread]: Running with dbt=1.0.3
02:27:30.632959 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:27:30.633246 [debug] [MainThread]: Tracking: tracking
02:27:30.653488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb3cf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb3cf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb3cf5e0>]}
02:27:30.715471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:27:30.716261 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:27:30.716456 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:27:30.716673 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:27:30.730143 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:27:30.746078 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:27:30.809403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:27:30.819122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2117389f-e6c1-4816-bc2c-19ff863ea294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb04f130>]}
02:27:30.826213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2117389f-e6c1-4816-bc2c-19ff863ea294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb0964f0>]}
02:27:30.826641 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:27:30.829054 [info ] [MainThread]: 
02:27:30.830340 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:27:30.831289 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:27:30.831594 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:27:31.616545 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:27:31.616960 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:27:31.782799 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:27:31.784291 [info ] [MainThread]: 
02:27:31.791152 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:27:31.791494 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:27:31.792850 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:27:31.793046 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:27:31.793266 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:27:31.797678 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:27:31.798080 [debug] [Thread-1  ]: finished collecting timing info
02:27:31.798272 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:27:31.814622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:27:31.992504 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:27:31.993064 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:27:40.710667 [debug] [Thread-1  ]: finished collecting timing info
02:27:40.711245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2117389f-e6c1-4816-bc2c-19ff863ea294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f9fb0e80>]}
02:27:40.711693 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.92s]
02:27:40.713281 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:27:40.713994 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:27:40.714287 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:27:40.715576 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:27:40.715763 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:27:40.715935 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:27:40.719016 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:27:40.719407 [debug] [Thread-3  ]: finished collecting timing info
02:27:40.719588 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:27:40.741337 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:27:40.741831 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:27:40.742083 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:27:41.506302 [debug] [Thread-3  ]: finished collecting timing info
02:27:41.506846 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2117389f-e6c1-4816-bc2c-19ff863ea294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f8756850>]}
02:27:41.507254 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.79s]
02:27:41.508722 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:27:41.510175 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:27:41.510570 [info ] [MainThread]: 
02:27:41.511635 [info ] [MainThread]: Finished running 1 table model, 1 view model in 10.68s.
02:27:41.512753 [debug] [MainThread]: Connection 'master' was properly closed.
02:27:41.512941 [debug] [MainThread]: Connection 'list_ae-project-341501' was properly closed.
02:27:41.513091 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:27:41.513231 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:27:41.522257 [info ] [MainThread]: 
02:27:41.523441 [info ] [MainThread]: [32mCompleted successfully[0m
02:27:41.524652 [info ] [MainThread]: 
02:27:41.525689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:27:41.526860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f9fb5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb082760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb082700>]}


============================== 2022-03-01 02:31:26.168784 | 9a13f3e6-58b1-4957-ac3e-84b6cf1a9457 ==============================
02:31:26.168784 [info ] [MainThread]: Running with dbt=1.0.3
02:31:26.173081 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:31:26.173404 [debug] [MainThread]: Tracking: tracking
02:31:26.197240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf4337a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf43378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf4337940>]}
02:31:26.257401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:31:26.258187 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:31:26.258368 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:31:26.258551 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:31:26.272651 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:31:26.287777 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:31:26.350763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:31:26.361300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a13f3e6-58b1-4957-ac3e-84b6cf1a9457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5beffb85e0>]}
02:31:26.368103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a13f3e6-58b1-4957-ac3e-84b6cf1a9457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5befffd220>]}
02:31:26.368450 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:31:26.370811 [info ] [MainThread]: 
02:31:26.372106 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:31:26.373126 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:31:26.373434 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:31:27.130302 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:31:27.130726 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:31:27.288197 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:31:27.289734 [info ] [MainThread]: 
02:31:27.295257 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:31:27.295574 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:31:27.296985 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:31:27.297176 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:31:27.297400 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:31:27.301807 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:31:27.302230 [debug] [Thread-1  ]: finished collecting timing info
02:31:27.302428 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:31:27.318843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:31:27.506754 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:31:27.507324 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:31:35.807554 [debug] [Thread-1  ]: finished collecting timing info
02:31:35.808127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a13f3e6-58b1-4957-ac3e-84b6cf1a9457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf4387610>]}
02:31:35.808583 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.51s]
02:31:35.810116 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:31:35.810809 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:31:35.811079 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:31:35.812353 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:31:35.812555 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:31:35.812724 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:31:35.815632 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:31:35.816008 [debug] [Thread-3  ]: finished collecting timing info
02:31:35.816186 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:31:35.837732 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:31:35.838138 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:31:35.838378 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:31:36.577008 [debug] [Thread-3  ]: finished collecting timing info
02:31:36.577551 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a13f3e6-58b1-4957-ac3e-84b6cf1a9457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bec679d90>]}
02:31:36.577955 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.77s]
02:31:36.579352 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:31:36.580764 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:31:36.581150 [info ] [MainThread]: 
02:31:36.582222 [info ] [MainThread]: Finished running 1 table model, 1 view model in 10.21s.
02:31:36.583374 [debug] [MainThread]: Connection 'master' was properly closed.
02:31:36.583553 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:31:36.583702 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:31:36.583841 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:31:36.592713 [info ] [MainThread]: 
02:31:36.593818 [info ] [MainThread]: [32mCompleted successfully[0m
02:31:36.595001 [info ] [MainThread]: 
02:31:36.596010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:31:36.598489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5beef2ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5befff2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5befff2ca0>]}


============================== 2022-03-01 02:32:08.876095 | 0be821a6-25c5-4a6c-a45b-796e83f6b3f7 ==============================
02:32:08.876095 [info ] [MainThread]: Running with dbt=1.0.3
02:32:08.880962 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:32:08.881260 [debug] [MainThread]: Tracking: tracking
02:32:08.900340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a92fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a92fa640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a92fa220>]}
02:32:08.962382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:32:08.963172 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:32:08.963350 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:32:08.963537 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:32:08.976747 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:32:08.991511 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:32:09.056291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:32:09.065697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0be821a6-25c5-4a6c-a45b-796e83f6b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a8f5d4f0>]}
02:32:09.072787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0be821a6-25c5-4a6c-a45b-796e83f6b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a8f48880>]}
02:32:09.073245 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:32:09.075632 [info ] [MainThread]: 
02:32:09.076965 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:32:09.077934 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:32:09.078244 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:32:09.864536 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:32:09.864949 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:32:10.022117 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:32:10.023674 [info ] [MainThread]: 
02:32:10.029446 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:32:10.029846 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:32:10.031370 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:32:10.031566 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:32:10.031789 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:32:10.036591 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:32:10.037073 [debug] [Thread-1  ]: finished collecting timing info
02:32:10.037274 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:32:10.054317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:32:10.221783 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:32:10.222347 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:32:18.130418 [debug] [Thread-1  ]: finished collecting timing info
02:32:18.130989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be821a6-25c5-4a6c-a45b-796e83f6b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a86e3970>]}
02:32:18.131437 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.10s]
02:32:18.132970 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:32:18.133669 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:32:18.133943 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:32:18.135208 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:32:18.135398 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:32:18.135568 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:32:18.138611 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:32:18.139005 [debug] [Thread-3  ]: finished collecting timing info
02:32:18.139192 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:32:18.160782 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:32:18.161277 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:32:18.161524 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:32:18.888523 [debug] [Thread-3  ]: finished collecting timing info
02:32:18.889055 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be821a6-25c5-4a6c-a45b-796e83f6b3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a8690a00>]}
02:32:18.889449 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.75s]
02:32:18.890888 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:32:18.892300 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:32:18.892718 [info ] [MainThread]: 
02:32:18.893793 [info ] [MainThread]: Finished running 1 table model, 1 view model in 9.82s.
02:32:18.894939 [debug] [MainThread]: Connection 'master' was properly closed.
02:32:18.895122 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:32:18.895275 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:32:18.895414 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:32:18.904200 [info ] [MainThread]: 
02:32:18.906725 [info ] [MainThread]: [32mCompleted successfully[0m
02:32:18.907880 [info ] [MainThread]: 
02:32:18.908960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:32:18.910157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a86e6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a8f48850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a92c2490>]}


============================== 2022-03-01 02:32:52.375073 | 800f76df-50e5-4cfe-93c2-31ad64acc6d0 ==============================
02:32:52.375073 [info ] [MainThread]: Running with dbt=1.0.3
02:32:52.381155 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:32:52.381473 [debug] [MainThread]: Tracking: tracking
02:32:52.400792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32703d0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32703d05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32703d08e0>]}
02:32:52.464687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:32:52.465490 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:32:52.465667 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:32:52.465849 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:32:52.479224 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:32:52.494822 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:32:52.560296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:32:52.569720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '800f76df-50e5-4cfe-93c2-31ad64acc6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3270071610>]}
02:32:52.576820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '800f76df-50e5-4cfe-93c2-31ad64acc6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327003b100>]}
02:32:52.577176 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:32:52.579584 [info ] [MainThread]: 
02:32:52.580923 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:32:52.581897 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:32:52.582208 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:32:53.330419 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:32:53.330838 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:32:53.485151 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:32:53.486671 [info ] [MainThread]: 
02:32:53.492093 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:32:53.492444 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:32:53.493977 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:32:53.494193 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:32:53.494418 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:32:53.498887 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:32:53.499290 [debug] [Thread-1  ]: finished collecting timing info
02:32:53.499482 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:32:53.517501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:32:53.694958 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:32:53.695516 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:33:01.546778 [debug] [Thread-1  ]: finished collecting timing info
02:33:01.547435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800f76df-50e5-4cfe-93c2-31ad64acc6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327041a4f0>]}
02:33:01.547983 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.05s]
02:33:01.549559 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:33:01.550273 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:33:01.550556 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:33:01.552112 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:33:01.552301 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:33:01.552472 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:33:01.555415 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:33:01.555807 [debug] [Thread-3  ]: finished collecting timing info
02:33:01.555991 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:33:01.579269 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:33:01.579828 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:33:01.580088 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:33:02.325864 [debug] [Thread-3  ]: finished collecting timing info
02:33:02.326400 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800f76df-50e5-4cfe-93c2-31ad64acc6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32687041c0>]}
02:33:02.326805 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.77s]
02:33:02.328244 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:33:02.329750 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:02.330143 [info ] [MainThread]: 
02:33:02.331239 [info ] [MainThread]: Finished running 1 table model, 1 view model in 9.75s.
02:33:02.332398 [debug] [MainThread]: Connection 'master' was properly closed.
02:33:02.332612 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:33:02.332760 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:33:02.332897 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:33:02.342077 [info ] [MainThread]: 
02:33:02.343372 [info ] [MainThread]: [32mCompleted successfully[0m
02:33:02.344606 [info ] [MainThread]: 
02:33:02.345633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:33:02.346794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327032de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326afb46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32703d0190>]}


============================== 2022-03-01 02:33:28.038002 | 84da365c-24c3-4cfe-b847-fe5ba47defdc ==============================
02:33:28.038002 [info ] [MainThread]: Running with dbt=1.0.3
02:33:28.040962 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:33:28.041277 [debug] [MainThread]: Tracking: tracking
02:33:28.065621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054b869a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054b868e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054b868b0>]}
02:33:28.127655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:33:28.127926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:33:28.128423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:33:28.138704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84da365c-24c3-4cfe-b847-fe5ba47defdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054ae6f70>]}
02:33:28.144984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84da365c-24c3-4cfe-b847-fe5ba47defdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054b63b80>]}
02:33:28.145374 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:33:28.147750 [info ] [MainThread]: 
02:33:28.149070 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:28.150115 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:33:28.150383 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:33:28.857796 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:33:28.859362 [info ] [MainThread]: 
02:33:28.865771 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:33:28.866010 [info ] [Thread-1  ]: 1 of 7 START test not_null_customers_customer_id................................ [RUN]
02:33:28.866383 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:33:28.866567 [info ] [Thread-2  ]: 2 of 7 START test not_null_monthly_customers_customers.......................... [RUN]
02:33:28.866974 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:33:28.867163 [info ] [Thread-3  ]: 3 of 7 START test not_null_monthly_customers_month.............................. [RUN]
02:33:28.867607 [debug] [Thread-4  ]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:33:28.867805 [info ] [Thread-4  ]: 4 of 7 START test source_unique_coffee_shop_customers_id........................ [RUN]
02:33:28.868113 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:33:28.868285 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id.................................. [RUN]
02:33:28.868864 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:33:28.869052 [info ] [Thread-6  ]: 6 of 7 START test unique_monthly_customers_customers............................ [RUN]
02:33:28.869352 [debug] [Thread-7  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:33:28.869525 [info ] [Thread-7  ]: 7 of 7 START test unique_monthly_customers_month................................ [RUN]
02:33:28.870444 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:33:28.870642 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:33:28.870869 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:33:28.877622 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:33:28.877816 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:33:28.877979 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:33:28.892167 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:33:28.894055 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:33:28.894816 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:33:28.897496 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:33:28.897687 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:33:28.895847 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:33:28.902812 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:33:28.902983 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:33:28.896392 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:33:28.909741 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:33:28.909937 [debug] [Thread-7  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:33:28.895511 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:33:28.895168 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:33:28.902592 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:33:28.916654 [debug] [Thread-3  ]: finished collecting timing info
02:33:28.916850 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:33:28.916104 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:33:28.923910 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:33:28.916291 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:33:28.928141 [debug] [Thread-4  ]: Compiling test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:33:28.915620 [debug] [Thread-2  ]: finished collecting timing info
02:33:28.932415 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:33:28.915876 [debug] [Thread-1  ]: finished collecting timing info
02:33:28.951983 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:33:28.915243 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:33:28.968087 [debug] [Thread-7  ]: finished collecting timing info
02:33:28.968281 [debug] [Thread-7  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:33:28.923653 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:33:28.974965 [debug] [Thread-6  ]: finished collecting timing info
02:33:28.975150 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:33:28.932161 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:33:28.977306 [debug] [Thread-4  ]: finished collecting timing info
02:33:28.977491 [debug] [Thread-4  ]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:33:28.979289 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:33:28.979677 [debug] [Thread-4  ]: Opening a new connection, currently in state init
02:33:28.979936 [debug] [Thread-4  ]: On test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:33:28.927917 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:33:28.981160 [debug] [Thread-5  ]: finished collecting timing info
02:33:28.981351 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:33:28.974608 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:33:28.983574 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:33:28.983787 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
02:33:28.970412 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:33:28.986011 [debug] [Thread-7  ]: Opening a new connection, currently in state init
02:33:28.986237 [debug] [Thread-7  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:33:28.967618 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:33:28.988192 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:33:28.976924 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:33:28.988820 [debug] [Thread-6  ]: Opening a new connection, currently in state init
02:33:28.989026 [debug] [Thread-6  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:33:28.988414 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
02:33:28.974204 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:33:28.992819 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:33:28.993034 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
02:33:28.983204 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:33:28.995143 [debug] [Thread-5  ]: Opening a new connection, currently in state init
02:33:28.995361 [debug] [Thread-5  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:33:30.197871 [debug] [Thread-1  ]: finished collecting timing info
02:33:30.198430 [info ] [Thread-1  ]: 1 of 7 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 1.33s]
02:33:30.202223 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:33:30.317563 [debug] [Thread-2  ]: finished collecting timing info
02:33:30.318074 [info ] [Thread-2  ]: 2 of 7 PASS not_null_monthly_customers_customers................................ [[32mPASS[0m in 1.44s]
02:33:30.319530 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:33:30.376587 [debug] [Thread-7  ]: finished collecting timing info
02:33:30.377102 [info ] [Thread-7  ]: 7 of 7 PASS unique_monthly_customers_month...................................... [[32mPASS[0m in 1.48s]
02:33:30.378551 [debug] [Thread-7  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:33:30.407523 [debug] [Thread-6  ]: finished collecting timing info
02:33:30.408005 [info ] [Thread-6  ]: 6 of 7 PASS unique_monthly_customers_customers.................................. [[32mPASS[0m in 1.51s]
02:33:30.409358 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:33:30.481813 [debug] [Thread-3  ]: finished collecting timing info
02:33:30.482330 [info ] [Thread-3  ]: 3 of 7 PASS not_null_monthly_customers_month.................................... [[32mPASS[0m in 1.59s]
02:33:30.483782 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:33:30.648802 [debug] [Thread-5  ]: finished collecting timing info
02:33:30.649323 [info ] [Thread-5  ]: 5 of 7 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 1.75s]
02:33:30.650816 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:33:30.787378 [debug] [Thread-4  ]: finished collecting timing info
02:33:30.787899 [info ] [Thread-4  ]: 4 of 7 PASS source_unique_coffee_shop_customers_id.............................. [[32mPASS[0m in 1.89s]
02:33:30.789347 [debug] [Thread-4  ]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:33:30.790988 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:33:30.791373 [info ] [MainThread]: 
02:33:30.792428 [info ] [MainThread]: Finished running 7 tests in 2.64s.
02:33:30.793608 [debug] [MainThread]: Connection 'master' was properly closed.
02:33:30.793788 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
02:33:30.793935 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:33:30.794081 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
02:33:30.794217 [debug] [MainThread]: Connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
02:33:30.794350 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:33:30.794627 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
02:33:30.794770 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
02:33:30.801271 [info ] [MainThread]: 
02:33:30.802551 [info ] [MainThread]: [32mCompleted successfully[0m
02:33:30.803675 [info ] [MainThread]: 
02:33:30.804705 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
02:33:30.805884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054acbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2054aecca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205426efa0>]}


============================== 2022-03-01 02:34:25.656589 | 682878f1-1c05-4005-9f01-5b216d8d9d2b ==============================
02:34:25.656589 [info ] [MainThread]: Running with dbt=1.0.3
02:34:25.661006 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, output=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='source-freshness', write_json=None)
02:34:25.661288 [debug] [MainThread]: Tracking: tracking
02:34:25.684906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c889a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c889610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c8898e0>]}
02:34:25.745404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:34:25.745674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:34:25.746175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:34:25.756621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '682878f1-1c05-4005-9f01-5b216d8d9d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c7e8fa0>]}
02:34:25.763034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '682878f1-1c05-4005-9f01-5b216d8d9d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c874c10>]}
02:34:25.763443 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:34:25.765701 [info ] [MainThread]: 
02:34:25.766750 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:34:25.772443 [info ] [MainThread]: Done.
02:34:25.773679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c874670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c874940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff62c874d30>]}


============================== 2022-03-01 02:34:57.179178 | eb2178da-3fe2-4d4e-854c-ced6368ec615 ==============================
02:34:57.179178 [info ] [MainThread]: Running with dbt=1.0.3
02:34:57.185060 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, output=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='source-freshness', write_json=None)
02:34:57.185338 [debug] [MainThread]: Tracking: tracking
02:34:57.204891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982f9d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982f9d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982f9d580>]}
02:34:57.268201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:34:57.269020 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:34:57.269207 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:34:57.269389 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:34:57.282595 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:34:57.297709 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:34:57.362494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:34:57.371722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb2178da-3fe2-4d4e-854c-ced6368ec615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982c214f0>]}
02:34:57.378666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb2178da-3fe2-4d4e-854c-ced6368ec615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982bed7f0>]}
02:34:57.379045 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:34:57.381224 [info ] [MainThread]: 
02:34:57.382293 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:34:57.387845 [info ] [MainThread]: Done.
02:34:57.388997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982bed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982bed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1982bed5b0>]}


============================== 2022-03-01 02:39:39.292407 | 48e3b88b-b3cf-4f83-9db3-644dae92f9a0 ==============================
02:39:39.292407 [info ] [MainThread]: Running with dbt=1.0.3
02:39:39.296945 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, output=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='source-freshness', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='source-freshness', write_json=None)
02:39:39.297234 [debug] [MainThread]: Tracking: tracking
02:39:39.316414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85472a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85472610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a854728e0>]}
02:39:39.380882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:39:39.381685 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.customers
02:39:39.381864 [debug] [MainThread]: Partial parsing: deleted source source.coffee_shop.coffee_shop.orders
02:39:39.382056 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/sources.yml
02:39:39.395141 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:39:39.409791 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:39:39.474826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:39:39.484081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48e3b88b-b3cf-4f83-9db3-644dae92f9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85111610>]}
02:39:39.491006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48e3b88b-b3cf-4f83-9db3-644dae92f9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a850dd160>]}
02:39:39.491422 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:39:39.493813 [info ] [MainThread]: 
02:39:39.495080 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:39:39.495940 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:39:39.496218 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:39:40.236669 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:39:40.238266 [info ] [MainThread]: 
02:39:40.244027 [debug] [Thread-1  ]: Began running node source.coffee_shop.coffee_shop.customers
02:39:40.244283 [info ] [Thread-1  ]: 1 of 2 START freshness of coffee_shop.customers................................. [RUN]
02:39:40.244957 [debug] [Thread-2  ]: Began running node source.coffee_shop.coffee_shop.orders
02:39:40.245147 [info ] [Thread-2  ]: 2 of 2 START freshness of coffee_shop.orders.................................... [RUN]
02:39:40.246328 [debug] [Thread-1  ]: Acquiring new bigquery connection "source.coffee_shop.coffee_shop.customers"
02:39:40.246524 [debug] [Thread-1  ]: Began compiling node source.coffee_shop.coffee_shop.customers
02:39:40.246745 [debug] [Thread-1  ]: finished collecting timing info
02:39:40.246922 [debug] [Thread-1  ]: Began executing node source.coffee_shop.coffee_shop.customers
02:39:40.247347 [debug] [Thread-1  ]: Acquiring new bigquery connection "source.coffee_shop.coffee_shop.customers"
02:39:40.254178 [debug] [Thread-2  ]: Acquiring new bigquery connection "source.coffee_shop.coffee_shop.orders"
02:39:40.254375 [debug] [Thread-2  ]: Began compiling node source.coffee_shop.coffee_shop.orders
02:39:40.254555 [debug] [Thread-2  ]: finished collecting timing info
02:39:40.254715 [debug] [Thread-2  ]: Began executing node source.coffee_shop.coffee_shop.orders
02:39:40.255094 [debug] [Thread-2  ]: Acquiring new bigquery connection "source.coffee_shop.coffee_shop.orders"
02:39:40.272740 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:39:40.275272 [debug] [Thread-1  ]: On source.coffee_shop.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "source.coffee_shop.coffee_shop.customers"} */
select
      max(created_at) as max_loaded_at,
      CURRENT_TIMESTAMP() as snapshotted_at
    from `analytics-engineers-club`.`coffee_shop`.`customers`
    
  
02:39:40.274975 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:39:40.277536 [debug] [Thread-2  ]: On source.coffee_shop.coffee_shop.orders: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "source.coffee_shop.coffee_shop.orders"} */
select
      max(created_at) as max_loaded_at,
      CURRENT_TIMESTAMP() as snapshotted_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    
  
02:39:40.693934 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/429d3dab-f255-45af-95b9-765153c23c78?maxResults=0&location=US&prettyPrint=false: Unrecognized name: created_at at [3:11]')
02:39:41.467397 [debug] [Thread-2  ]: finished collecting timing info
02:39:41.467859 [error] [Thread-2  ]: 2 of 2 ERROR STALE freshness of coffee_shop.orders.............................. [[31mERROR STALE[0m in 1.21s]
02:39:41.469354 [debug] [Thread-2  ]: Finished running node source.coffee_shop.coffee_shop.orders
02:39:42.079376 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
macro collect_freshness
02:39:42.079617 [debug] [Thread-1  ]: BigQuery adapter: Database Error
  Unrecognized name: created_at at [3:11]
02:39:42.080044 [debug] [Thread-1  ]: finished collecting timing info
02:39:42.080402 [debug] [Thread-1  ]: Database Error in source customers (models/sources.yml)
  Unrecognized name: created_at at [3:11]
02:39:42.080693 [error] [Thread-1  ]: 1 of 2 ERROR freshness of coffee_shop.customers................................. [[31mERROR[0m in 1.83s]
02:39:42.082138 [debug] [Thread-1  ]: Finished running node source.coffee_shop.coffee_shop.customers
02:39:42.083432 [debug] [MainThread]: Connection 'master' was properly closed.
02:39:42.083616 [debug] [MainThread]: Connection 'source.coffee_shop.coffee_shop.orders' was properly closed.
02:39:42.083766 [debug] [MainThread]: Connection 'source.coffee_shop.coffee_shop.customers' was properly closed.
02:39:42.090073 [info ] [MainThread]: 
02:39:42.091537 [info ] [MainThread]: 
02:39:42.092657 [error] [MainThread]: [33mDatabase Error in source customers (models/sources.yml)[0m
02:39:42.093751 [error] [MainThread]:   Unrecognized name: created_at at [3:11]
02:39:42.094851 [info ] [MainThread]: Done.
02:39:42.096164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a84870c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a84870e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a84870df0>]}


============================== 2022-03-01 02:39:48.756519 | c6692692-c97f-492d-a679-b8cbad746214 ==============================
02:39:48.756519 [info ] [MainThread]: Running with dbt=1.0.3
02:39:48.760991 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:39:48.761288 [debug] [MainThread]: Tracking: tracking
02:39:48.784545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d18fba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d18fb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d18fb910>]}
02:39:48.845006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:39:48.845271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:39:48.845760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:39:48.855911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6692692-c97f-492d-a679-b8cbad746214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d185bf70>]}
02:39:48.862399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6692692-c97f-492d-a679-b8cbad746214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d18e0b80>]}
02:39:48.862823 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:39:48.865549 [info ] [MainThread]: 
02:39:48.866947 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:39:48.868026 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:39:48.868295 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:39:49.626965 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:39:49.628608 [info ] [MainThread]: 
02:39:49.634976 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:39:49.635206 [info ] [Thread-1  ]: 1 of 7 START test not_null_customers_customer_id................................ [RUN]
02:39:49.635552 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:39:49.635725 [info ] [Thread-2  ]: 2 of 7 START test not_null_monthly_customers_customers.......................... [RUN]
02:39:49.636016 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:39:49.636188 [info ] [Thread-3  ]: 3 of 7 START test not_null_monthly_customers_month.............................. [RUN]
02:39:49.636477 [debug] [Thread-4  ]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:39:49.636687 [info ] [Thread-4  ]: 4 of 7 START test source_unique_coffee_shop_customers_id........................ [RUN]
02:39:49.636976 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:39:49.637142 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id.................................. [RUN]
02:39:49.637433 [debug] [Thread-6  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:39:49.637609 [info ] [Thread-6  ]: 6 of 7 START test unique_monthly_customers_customers............................ [RUN]
02:39:49.637899 [debug] [Thread-7  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:39:49.638064 [info ] [Thread-7  ]: 7 of 7 START test unique_monthly_customers_month................................ [RUN]
02:39:49.639362 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:39:49.639554 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:39:49.639778 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:39:49.646153 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:39:49.646340 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:39:49.646503 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:39:49.657872 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:39:49.658556 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:39:49.663074 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:39:49.663266 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:39:49.659557 [debug] [Thread-6  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:39:49.667441 [debug] [Thread-6  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:39:49.667622 [debug] [Thread-6  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:39:49.659892 [debug] [Thread-7  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:39:49.674069 [debug] [Thread-7  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:39:49.658897 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:39:49.674452 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:39:49.674611 [debug] [Thread-4  ]: Compiling test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:39:49.662789 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:39:49.680258 [debug] [Thread-2  ]: finished collecting timing info
02:39:49.659230 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:39:49.667227 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:39:49.681015 [debug] [Thread-3  ]: finished collecting timing info
02:39:49.681188 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:39:49.673861 [debug] [Thread-1  ]: finished collecting timing info
02:39:49.686963 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:39:49.680682 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:39:49.705194 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:39:49.680458 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:39:49.674240 [debug] [Thread-7  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:39:49.679901 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:39:49.737080 [debug] [Thread-4  ]: finished collecting timing info
02:39:49.737276 [debug] [Thread-4  ]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:39:49.704960 [debug] [Thread-6  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:39:49.740098 [debug] [Thread-6  ]: finished collecting timing info
02:39:49.740284 [debug] [Thread-6  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:39:49.709042 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:39:49.742344 [debug] [Thread-5  ]: finished collecting timing info
02:39:49.742521 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:39:49.744298 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:39:49.727452 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:39:49.744777 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:39:49.745044 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
02:39:49.724669 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:39:49.746264 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:39:49.746473 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
02:39:49.735936 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:39:49.748608 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:39:49.748820 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
02:39:49.742005 [debug] [Thread-6  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:39:49.750952 [debug] [Thread-6  ]: Opening a new connection, currently in state init
02:39:49.739274 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:39:49.752673 [debug] [Thread-4  ]: Opening a new connection, currently in state init
02:39:49.752886 [debug] [Thread-4  ]: On test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:39:49.750589 [debug] [Thread-5  ]: Opening a new connection, currently in state init
02:39:49.753923 [debug] [Thread-5  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:39:49.751162 [debug] [Thread-6  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:39:49.732423 [debug] [Thread-7  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:39:49.757076 [debug] [Thread-7  ]: finished collecting timing info
02:39:49.757261 [debug] [Thread-7  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:39:49.759183 [debug] [Thread-7  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:39:49.762438 [debug] [Thread-7  ]: Opening a new connection, currently in state init
02:39:49.762769 [debug] [Thread-7  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:39:50.587741 [debug] [Thread-2  ]: finished collecting timing info
02:39:50.588296 [info ] [Thread-2  ]: 2 of 7 PASS not_null_monthly_customers_customers................................ [[32mPASS[0m in 0.94s]
02:39:50.589798 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:39:50.620740 [debug] [Thread-1  ]: finished collecting timing info
02:39:50.623146 [info ] [Thread-1  ]: 1 of 7 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 0.98s]
02:39:50.622697 [debug] [Thread-4  ]: finished collecting timing info
02:39:50.624354 [info ] [Thread-4  ]: 4 of 7 PASS source_unique_coffee_shop_customers_id.............................. [[32mPASS[0m in 0.97s]
02:39:50.625147 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:39:50.626279 [debug] [Thread-4  ]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:39:50.628436 [debug] [Thread-6  ]: finished collecting timing info
02:39:50.628843 [info ] [Thread-6  ]: 6 of 7 PASS unique_monthly_customers_customers.................................. [[32mPASS[0m in 0.97s]
02:39:50.630189 [debug] [Thread-6  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:39:50.656141 [debug] [Thread-5  ]: finished collecting timing info
02:39:50.656676 [info ] [Thread-5  ]: 5 of 7 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 1.00s]
02:39:50.658117 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:39:50.696561 [debug] [Thread-3  ]: finished collecting timing info
02:39:50.697076 [info ] [Thread-3  ]: 3 of 7 PASS not_null_monthly_customers_month.................................... [[32mPASS[0m in 1.04s]
02:39:50.698486 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:39:50.744385 [debug] [Thread-7  ]: finished collecting timing info
02:39:50.744922 [info ] [Thread-7  ]: 7 of 7 PASS unique_monthly_customers_month...................................... [[32mPASS[0m in 1.09s]
02:39:50.746365 [debug] [Thread-7  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:39:50.748052 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:39:50.748441 [info ] [MainThread]: 
02:39:50.748972 [info ] [MainThread]: Finished running 7 tests in 1.88s.
02:39:50.749470 [debug] [MainThread]: Connection 'master' was properly closed.
02:39:50.749640 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
02:39:50.749785 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:39:50.749934 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
02:39:50.750079 [debug] [MainThread]: Connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
02:39:50.750214 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:39:50.750347 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
02:39:50.750479 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
02:39:50.757355 [info ] [MainThread]: 
02:39:50.758580 [info ] [MainThread]: [32mCompleted successfully[0m
02:39:50.759739 [info ] [MainThread]: 
02:39:50.760852 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
02:39:50.762121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d1949370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d1949640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2d1949340>]}


============================== 2022-03-01 02:42:04.349758 | dce9ad83-efb7-4943-a4d4-598555840f04 ==============================
02:42:04.349758 [info ] [MainThread]: Running with dbt=1.0.3
02:42:04.353044 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:42:04.353402 [debug] [MainThread]: Tracking: tracking
02:42:04.377260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe141854700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe141854610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe141854580>]}
02:42:04.439713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:42:04.439988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:42:04.440543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:42:04.450848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce9ad83-efb7-4943-a4d4-598555840f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe141796ee0>]}
02:42:04.457596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce9ad83-efb7-4943-a4d4-598555840f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14181aaf0>]}
02:42:04.458053 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:42:04.460287 [info ] [MainThread]: 
02:42:04.461639 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:04.462567 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:42:04.462873 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:05.271745 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:42:05.272177 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:05.434131 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:42:05.435666 [info ] [MainThread]: 
02:42:05.441843 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:42:05.442184 [info ] [Thread-1  ]: 1 of 1 START table model coffee_shop.customers.................................. [RUN]
02:42:05.443536 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:42:05.443739 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:42:05.443958 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:42:05.448459 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:42:05.448896 [debug] [Thread-1  ]: finished collecting timing info
02:42:05.449090 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:42:05.465622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:42:05.648687 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:42:05.649219 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:42:14.346153 [debug] [Thread-1  ]: finished collecting timing info
02:42:14.346715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce9ad83-efb7-4943-a4d4-598555840f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14069e940>]}
02:42:14.347166 [info ] [Thread-1  ]: 1 of 1 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.90s]
02:42:14.348704 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:42:14.350116 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:14.350494 [info ] [MainThread]: 
02:42:14.351542 [info ] [MainThread]: Finished running 1 table model in 9.89s.
02:42:14.352648 [debug] [MainThread]: Connection 'master' was properly closed.
02:42:14.352829 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:42:14.352975 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:42:14.359091 [info ] [MainThread]: 
02:42:14.360304 [info ] [MainThread]: [32mCompleted successfully[0m
02:42:14.361486 [info ] [MainThread]: 
02:42:14.362486 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:42:14.363622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe141724fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe140f1b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14177cd00>]}


============================== 2022-03-01 02:42:20.800019 | 115f84d3-468e-4c47-b17e-920ce98b6f28 ==============================
02:42:20.800019 [info ] [MainThread]: Running with dbt=1.0.3
02:42:20.804985 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:42:20.805284 [debug] [MainThread]: Tracking: tracking
02:42:20.828566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a06bb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a06bb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a06bb220>]}
02:42:20.890175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:42:20.890445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:42:20.890962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:42:20.901283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '115f84d3-468e-4c47-b17e-920ce98b6f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a05bef40>]}
02:42:20.908348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '115f84d3-468e-4c47-b17e-920ce98b6f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a0643b50>]}
02:42:20.908780 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:42:20.911013 [info ] [MainThread]: 
02:42:20.912282 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:20.913298 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:42:20.913616 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:21.684963 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:42:21.685377 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:21.844218 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:42:21.845742 [info ] [MainThread]: 
02:42:21.851751 [debug] [Thread-1  ]: Began running node model.coffee_shop.customers
02:42:21.852127 [info ] [Thread-1  ]: 1 of 2 START table model coffee_shop.customers.................................. [RUN]
02:42:21.853613 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.customers"
02:42:21.853814 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.customers
02:42:21.854042 [debug] [Thread-1  ]: Compiling model.coffee_shop.customers
02:42:21.858560 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.customers"
02:42:21.858989 [debug] [Thread-1  ]: finished collecting timing info
02:42:21.859183 [debug] [Thread-1  ]: Began executing node model.coffee_shop.customers
02:42:21.875823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:42:22.066886 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.customers"
02:42:22.067431 [debug] [Thread-1  ]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace table `ae-project-341501`.`coffee_shop`.`customers`
  
  
  OPTIONS()
  as (
    

SELECT c.id as customer_id, 
        c.name, 
        c.email,  
        min(o.created_at) as first_order_at, 
        count(distinct o.id) as number_of_orders
FROM `analytics-engineers-club`.`coffee_shop`.`customers` c 
LEFT JOIN  `analytics-engineers-club`.`coffee_shop`.`orders` o on c.id = o.customer_id
GROUP BY 1, 2, 3
ORDER BY first_order_at
  );
  
02:42:29.898922 [debug] [Thread-1  ]: finished collecting timing info
02:42:29.899485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115f84d3-468e-4c47-b17e-920ce98b6f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539f4c8820>]}
02:42:29.899939 [info ] [Thread-1  ]: 1 of 2 OK created table model coffee_shop.customers............................. [[32mCREATE TABLE (174.4k rows, 28.2 MB processed)[0m in 8.05s]
02:42:29.901466 [debug] [Thread-1  ]: Finished running node model.coffee_shop.customers
02:42:29.902148 [debug] [Thread-3  ]: Began running node model.coffee_shop.monthly_customers
02:42:29.902432 [info ] [Thread-3  ]: 2 of 2 START view model coffee_shop.monthly_customers........................... [RUN]
02:42:29.903720 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:42:29.903909 [debug] [Thread-3  ]: Began compiling node model.coffee_shop.monthly_customers
02:42:29.904083 [debug] [Thread-3  ]: Compiling model.coffee_shop.monthly_customers
02:42:29.907004 [debug] [Thread-3  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:42:29.907380 [debug] [Thread-3  ]: finished collecting timing info
02:42:29.907561 [debug] [Thread-3  ]: Began executing node model.coffee_shop.monthly_customers
02:42:29.929063 [debug] [Thread-3  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:42:29.929506 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:42:29.929756 [debug] [Thread-3  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:42:30.668610 [debug] [Thread-3  ]: finished collecting timing info
02:42:30.669153 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115f84d3-468e-4c47-b17e-920ce98b6f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c46fd30>]}
02:42:30.669554 [info ] [Thread-3  ]: 2 of 2 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.77s]
02:42:30.671024 [debug] [Thread-3  ]: Finished running node model.coffee_shop.monthly_customers
02:42:30.672522 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:30.672922 [info ] [MainThread]: 
02:42:30.674011 [info ] [MainThread]: Finished running 1 table model, 1 view model in 9.76s.
02:42:30.675152 [debug] [MainThread]: Connection 'master' was properly closed.
02:42:30.675344 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
02:42:30.675495 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:42:30.675637 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:42:30.681628 [info ] [MainThread]: 
02:42:30.682763 [info ] [MainThread]: [32mCompleted successfully[0m
02:42:30.683947 [info ] [MainThread]: 
02:42:30.684999 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:42:30.686157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539fd446a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539fd44580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53a066c700>]}


============================== 2022-03-01 02:42:40.208151 | 4c61bde0-9624-4448-992d-b57e0258ddf2 ==============================
02:42:40.208151 [info ] [MainThread]: Running with dbt=1.0.3
02:42:40.213044 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['monthly_customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:42:40.213369 [debug] [MainThread]: Tracking: tracking
02:42:40.236782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bd6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bd6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bd6a00>]}
02:42:40.297405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:42:40.297674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:42:40.298187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:42:40.308605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c61bde0-9624-4448-992d-b57e0258ddf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8b36f70>]}
02:42:40.314931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c61bde0-9624-4448-992d-b57e0258ddf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bbab80>]}
02:42:40.315314 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:42:40.317367 [info ] [MainThread]: 
02:42:40.318611 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:40.319511 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501"
02:42:40.319818 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:41.087618 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:42:41.088035 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:42:41.242141 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:42:41.243733 [info ] [MainThread]: 
02:42:41.249936 [debug] [Thread-1  ]: Began running node model.coffee_shop.monthly_customers
02:42:41.250299 [info ] [Thread-1  ]: 1 of 1 START view model coffee_shop.monthly_customers........................... [RUN]
02:42:41.251741 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.coffee_shop.monthly_customers"
02:42:41.251949 [debug] [Thread-1  ]: Began compiling node model.coffee_shop.monthly_customers
02:42:41.252173 [debug] [Thread-1  ]: Compiling model.coffee_shop.monthly_customers
02:42:41.255876 [debug] [Thread-1  ]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
02:42:41.256393 [debug] [Thread-1  ]: finished collecting timing info
02:42:41.256632 [debug] [Thread-1  ]: Began executing node model.coffee_shop.monthly_customers
02:42:41.291322 [debug] [Thread-1  ]: Writing runtime SQL for node "model.coffee_shop.monthly_customers"
02:42:41.291850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:42:41.292131 [debug] [Thread-1  ]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `ae-project-341501`.`coffee_shop`.`monthly_customers`
  OPTIONS()
  as SELECT 
    date_trunc(first_order_at, month) as month,
    count(customer_id) as customers
FROM `ae-project-341501`.`coffee_shop`.`customers`
GROUP BY 1;


02:42:42.017914 [debug] [Thread-1  ]: finished collecting timing info
02:42:42.018488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c61bde0-9624-4448-992d-b57e0258ddf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f823eac0>]}
02:42:42.018930 [info ] [Thread-1  ]: 1 of 1 OK created view model coffee_shop.monthly_customers...................... [[32mOK[0m in 0.77s]
02:42:42.020376 [debug] [Thread-1  ]: Finished running node model.coffee_shop.monthly_customers
02:42:42.021817 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:42:42.022200 [info ] [MainThread]: 
02:42:42.023268 [info ] [MainThread]: Finished running 1 view model in 1.70s.
02:42:42.024373 [debug] [MainThread]: Connection 'master' was properly closed.
02:42:42.024588 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
02:42:42.024740 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:42:42.030851 [info ] [MainThread]: 
02:42:42.032118 [info ] [MainThread]: [32mCompleted successfully[0m
02:42:42.033250 [info ] [MainThread]: 
02:42:42.034242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:42:42.035394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bbad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bba970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f8bbad00>]}


============================== 2022-03-01 02:43:29.743835 | f86e8e31-35d7-484f-83aa-6a3211374929 ==============================
02:43:29.743835 [info ] [MainThread]: Running with dbt=1.0.3
02:43:29.749776 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['sources'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:43:29.750071 [debug] [MainThread]: Tracking: tracking
02:43:29.766986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c3fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c3f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c3f970>]}
02:43:29.833513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:43:29.833796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:43:29.834291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:43:29.844793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f86e8e31-35d7-484f-83aa-6a3211374929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10ba2f10>]}
02:43:29.851146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f86e8e31-35d7-484f-83aa-6a3211374929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c26cd0>]}
02:43:29.851494 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:43:29.853012 [warn ] [MainThread]: The selection criterion 'sources' does not match any nodes
02:43:29.854449 [info ] [MainThread]: 
02:43:29.855455 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:43:29.861290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c26e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c26e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef10c26af0>]}


============================== 2022-03-01 02:44:54.228526 | 9aee41e7-542d-446c-8f48-abf72e6e6b34 ==============================
02:44:54.228526 [info ] [MainThread]: Running with dbt=1.0.3
02:44:54.233001 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['source:coffee_shop'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:44:54.233285 [debug] [MainThread]: Tracking: tracking
02:44:54.256896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ddda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ddd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964ddd8e0>]}
02:44:54.316269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:44:54.316559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:44:54.317096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:44:54.327296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aee41e7-542d-446c-8f48-abf72e6e6b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964d43fa0>]}
02:44:54.333568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aee41e7-542d-446c-8f48-abf72e6e6b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964dc7c10>]}
02:44:54.333964 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:44:54.335872 [info ] [MainThread]: 
02:44:54.337109 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:44:54.338140 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:44:54.338409 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:44:55.089522 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:44:55.091156 [info ] [MainThread]: 
02:44:55.097505 [debug] [Thread-1  ]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:44:55.097744 [info ] [Thread-1  ]: 1 of 1 START test source_unique_coffee_shop_customers_id........................ [RUN]
02:44:55.099099 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:44:55.099310 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:44:55.099535 [debug] [Thread-1  ]: Compiling test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:44:55.112966 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:44:55.113411 [debug] [Thread-1  ]: finished collecting timing info
02:44:55.113609 [debug] [Thread-1  ]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:44:55.136351 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
02:44:55.136843 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:44:55.137113 [debug] [Thread-1  ]: On test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:44:56.035338 [debug] [Thread-1  ]: finished collecting timing info
02:44:56.035890 [info ] [Thread-1  ]: 1 of 1 PASS source_unique_coffee_shop_customers_id.............................. [[32mPASS[0m in 0.94s]
02:44:56.037364 [debug] [Thread-1  ]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
02:44:56.038814 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:44:56.039183 [info ] [MainThread]: 
02:44:56.040221 [info ] [MainThread]: Finished running 1 test in 1.70s.
02:44:56.041370 [debug] [MainThread]: Connection 'master' was properly closed.
02:44:56.041550 [debug] [MainThread]: Connection 'list_ae-project-341501_coffee_shop' was properly closed.
02:44:56.041695 [debug] [MainThread]: Connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
02:44:56.047887 [info ] [MainThread]: 
02:44:56.049285 [info ] [MainThread]: [32mCompleted successfully[0m
02:44:56.050550 [info ] [MainThread]: 
02:44:56.051561 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:44:56.052766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9644c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964d48190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964dc7dc0>]}


============================== 2022-03-01 02:45:16.575449 | 7d111b8d-6597-4cb5-a740-a3212ccd310e ==============================
02:45:16.575449 [info ] [MainThread]: Running with dbt=1.0.3
02:45:16.581011 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['source:customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:45:16.581312 [debug] [MainThread]: Tracking: tracking
02:45:16.600772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9217959a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921795940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921795910>]}
02:45:16.665248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:45:16.665516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:45:16.666060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:45:16.676278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d111b8d-6597-4cb5-a740-a3212ccd310e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9216aff70>]}
02:45:16.682720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d111b8d-6597-4cb5-a740-a3212ccd310e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921733b80>]}
02:45:16.683103 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:45:16.684814 [warn ] [MainThread]: The selection criterion 'source:customers' does not match any nodes
02:45:16.686268 [info ] [MainThread]: 
02:45:16.687309 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:45:16.693309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921733d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921733d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921733940>]}


============================== 2022-03-01 02:46:50.537576 | 4f35904f-d60b-4672-8a00-1d9976affec6 ==============================
02:46:50.537576 [info ] [MainThread]: Running with dbt=1.0.3
02:46:50.540943 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:46:50.541224 [debug] [MainThread]: Tracking: tracking
02:46:50.565731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a517b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a517730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a517670>]}
02:46:50.625103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:46:50.625799 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
02:46:50.639815 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:46:50.700650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:46:50.709564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f35904f-d60b-4672-8a00-1d9976affec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a1fc5b0>]}
02:46:50.716103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f35904f-d60b-4672-8a00-1d9976affec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a45cca0>]}
02:46:50.716475 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:46:50.718781 [info ] [MainThread]: 
02:46:50.720041 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:46:50.721103 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:46:50.721371 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:46:51.483737 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:46:51.485354 [info ] [MainThread]: 
02:46:51.491046 [debug] [Thread-1  ]: Began running node test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b
02:46:51.491278 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_customers_customer_id__placed__shipped__completed__returned [RUN]
02:46:51.491637 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:46:51.491817 [info ] [Thread-2  ]: 2 of 3 START test not_null_customers_customer_id................................ [RUN]
02:46:51.492238 [debug] [Thread-3  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:46:51.492430 [info ] [Thread-3  ]: 3 of 3 START test unique_customers_customer_id.................................. [RUN]
02:46:51.493704 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b"
02:46:51.493909 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b
02:46:51.494133 [debug] [Thread-1  ]: Compiling test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b
02:46:51.502190 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:46:51.502397 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:46:51.502567 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:46:51.511040 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b"
02:46:51.511808 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:46:51.512694 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:46:51.512884 [debug] [Thread-3  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:46:51.520239 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:46:51.520608 [debug] [Thread-1  ]: finished collecting timing info
02:46:51.522021 [debug] [Thread-1  ]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b
02:46:51.521731 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:46:51.530177 [debug] [Thread-2  ]: finished collecting timing info
02:46:51.529833 [debug] [Thread-3  ]: finished collecting timing info
02:46:51.530582 [debug] [Thread-3  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:46:51.530401 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:46:51.577350 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:46:51.580664 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:46:51.579206 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b"
02:46:51.582187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:46:51.582445 [debug] [Thread-1  ]: On test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `ae-project-341501`.`coffee_shop`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','returned'
)



      
    ) dbt_internal_test
02:46:51.581215 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:46:51.584705 [debug] [Thread-2  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
02:46:51.586526 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:46:51.586746 [debug] [Thread-3  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:46:52.762350 [debug] [Thread-2  ]: finished collecting timing info
02:46:52.762909 [info ] [Thread-2  ]: 2 of 3 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 1.26s]
02:46:52.764356 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:46:53.208140 [debug] [Thread-1  ]: finished collecting timing info
02:46:53.208685 [error] [Thread-1  ]: 1 of 3 FAIL 174397 accepted_values_customers_customer_id__placed__shipped__completed__returned [[31mFAIL 174397[0m in 1.72s]
02:46:53.210153 [debug] [Thread-1  ]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b
02:46:53.397150 [debug] [Thread-3  ]: finished collecting timing info
02:46:53.397668 [info ] [Thread-3  ]: 3 of 3 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 1.89s]
02:46:53.399064 [debug] [Thread-3  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:46:53.400583 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:46:53.400968 [info ] [MainThread]: 
02:46:53.402008 [info ] [MainThread]: Finished running 3 tests in 2.68s.
02:46:53.403130 [debug] [MainThread]: Connection 'master' was properly closed.
02:46:53.403311 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__placed__shipped__completed__returned.f16abf5d5b' was properly closed.
02:46:53.403461 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:46:53.403600 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:46:53.410035 [info ] [MainThread]: 
02:46:53.411175 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:46:53.412244 [info ] [MainThread]: 
02:46:53.413266 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__placed__shipped__completed__returned (models/schema.yml)[0m
02:46:53.414308 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
02:46:53.415345 [info ] [MainThread]: 
02:46:53.416389 [info ] [MainThread]:   compiled SQL at target/compiled/coffee_shop/models/schema.yml/accepted_values_customers_d83e6da7bcd8fcae0ac19b731e8fceaa.sql
02:46:53.418074 [info ] [MainThread]: 
02:46:53.419134 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:46:53.420280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a5644c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a45ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a45cc40>]}


============================== 2022-03-01 02:47:11.886429 | bea11b11-daf9-430d-bd20-c19cd670253a ==============================
02:47:11.886429 [info ] [MainThread]: Running with dbt=1.0.3
02:47:11.888978 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:47:11.889324 [debug] [MainThread]: Tracking: tracking
02:47:11.913267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f591d5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f591d5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f591d5220>]}
02:47:11.976869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:47:11.977567 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
02:47:11.990844 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
02:47:12.036033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:47:12.045105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bea11b11-daf9-430d-bd20-c19cd670253a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f58e9bd00>]}
02:47:12.051543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bea11b11-daf9-430d-bd20-c19cd670253a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5918fd00>]}
02:47:12.051982 [info ] [MainThread]: Found 2 models, 7 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:47:12.054326 [info ] [MainThread]: 
02:47:12.055614 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:12.056687 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:47:12.056963 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:47:12.795089 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:47:12.796749 [info ] [MainThread]: 
02:47:12.802368 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:12.802662 [info ] [Thread-1  ]: 1 of 2 START test not_null_customers_customer_id................................ [RUN]
02:47:12.803067 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:12.803245 [info ] [Thread-2  ]: 2 of 2 START test unique_customers_customer_id.................................. [RUN]
02:47:12.804825 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:12.805042 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:12.805276 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:12.814187 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:12.814385 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:12.814555 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:12.829209 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:12.830636 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:12.831152 [debug] [Thread-2  ]: finished collecting timing info
02:47:12.831354 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:12.837825 [debug] [Thread-1  ]: finished collecting timing info
02:47:12.838037 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:12.876006 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:12.876570 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:47:12.876878 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:12.877544 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:47:12.877758 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
02:47:12.877181 [debug] [Thread-2  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:47:13.735756 [debug] [Thread-1  ]: finished collecting timing info
02:47:13.736347 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 0.93s]
02:47:13.738367 [debug] [Thread-2  ]: finished collecting timing info
02:47:13.738941 [info ] [Thread-2  ]: 2 of 2 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 0.92s]
02:47:13.740376 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:13.741541 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:13.742971 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:13.743358 [info ] [MainThread]: 
02:47:13.744472 [info ] [MainThread]: Finished running 2 tests in 1.69s.
02:47:13.745655 [debug] [MainThread]: Connection 'master' was properly closed.
02:47:13.745841 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:47:13.745996 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:47:13.752130 [info ] [MainThread]: 
02:47:13.753329 [info ] [MainThread]: [32mCompleted successfully[0m
02:47:13.754382 [info ] [MainThread]: 
02:47:13.755398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:47:13.756579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f591c82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5918ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5918feb0>]}


============================== 2022-03-01 02:47:28.955262 | 2cb29a9a-04b1-426a-b52a-839387e466b2 ==============================
02:47:28.955262 [info ] [MainThread]: Running with dbt=1.0.3
02:47:28.961034 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:47:28.961333 [debug] [MainThread]: Tracking: tracking
02:47:28.976429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25fc0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25fc0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25fc05e0>]}
02:47:29.044911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:47:29.045611 [debug] [MainThread]: Partial parsing: update schema file: coffee_shop://models/schema.yml
02:47:29.058832 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
02:47:29.126255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:47:29.136647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb29a9a-04b1-426a-b52a-839387e466b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25c89a90>]}
02:47:29.143408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb29a9a-04b1-426a-b52a-839387e466b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25ee9a90>]}
02:47:29.143869 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:47:29.146173 [info ] [MainThread]: 
02:47:29.147467 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:29.148546 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:47:29.148818 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:47:29.863948 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:47:29.865500 [info ] [MainThread]: 
02:47:29.870959 [debug] [Thread-1  ]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:29.871185 [info ] [Thread-1  ]: 1 of 2 START test not_null_customers_customer_id................................ [RUN]
02:47:29.871548 [debug] [Thread-2  ]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:29.871728 [info ] [Thread-2  ]: 2 of 2 START test unique_customers_customer_id.................................. [RUN]
02:47:29.873084 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:29.873281 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:29.873509 [debug] [Thread-1  ]: Compiling test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:29.882197 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:29.882393 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:29.882563 [debug] [Thread-2  ]: Compiling test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:29.890415 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:29.892210 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:29.892772 [debug] [Thread-1  ]: finished collecting timing info
02:47:29.892977 [debug] [Thread-1  ]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:29.901790 [debug] [Thread-2  ]: finished collecting timing info
02:47:29.901992 [debug] [Thread-2  ]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:29.930986 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
02:47:29.931487 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:47:29.931763 [debug] [Thread-2  ]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customer_id as unique_field
  from `ae-project-341501`.`coffee_shop`.`customers`
  where customer_id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:47:29.935177 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
02:47:29.935572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:47:29.935788 [debug] [Thread-1  ]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`customers`
where customer_id is null



      
    ) dbt_internal_test
02:47:30.757594 [debug] [Thread-2  ]: finished collecting timing info
02:47:30.758151 [info ] [Thread-2  ]: 2 of 2 PASS unique_customers_customer_id........................................ [[32mPASS[0m in 0.88s]
02:47:30.759620 [debug] [Thread-2  ]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
02:47:30.789434 [debug] [Thread-1  ]: finished collecting timing info
02:47:30.789953 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customers_customer_id...................................... [[32mPASS[0m in 0.92s]
02:47:30.791371 [debug] [Thread-1  ]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
02:47:30.792865 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:30.793269 [info ] [MainThread]: 
02:47:30.794339 [info ] [MainThread]: Finished running 2 tests in 1.65s.
02:47:30.795484 [debug] [MainThread]: Connection 'master' was properly closed.
02:47:30.795674 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
02:47:30.795829 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
02:47:30.802681 [info ] [MainThread]: 
02:47:30.806403 [info ] [MainThread]: [32mCompleted successfully[0m
02:47:30.807494 [info ] [MainThread]: 
02:47:30.808514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
02:47:30.809755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25ee9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25ee9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd25fa6340>]}


============================== 2022-03-01 02:47:40.595333 | 9ffd269f-f2c5-4d1e-851a-16d619ebf738 ==============================
02:47:40.595333 [info ] [MainThread]: Running with dbt=1.0.3
02:47:40.601034 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/home/ubuntu/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['monthly_customers'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
02:47:40.601337 [debug] [MainThread]: Tracking: tracking
02:47:40.620413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8e17700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8e17640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8e17220>]}
02:47:40.682304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:47:40.682574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:47:40.683082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_dbt.example

02:47:40.693266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ffd269f-f2c5-4d1e-851a-16d619ebf738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8d5cfd0>]}
02:47:40.700896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ffd269f-f2c5-4d1e-851a-16d619ebf738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8dbeeb0>]}
02:47:40.701398 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
02:47:40.703775 [info ] [MainThread]: 
02:47:40.705139 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:40.706253 [debug] [ThreadPool]: Acquiring new bigquery connection "list_ae-project-341501_coffee_shop"
02:47:40.706528 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:47:41.430813 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
02:47:41.432438 [info ] [MainThread]: 
02:47:41.438144 [debug] [Thread-1  ]: Began running node test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615
02:47:41.438386 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_monthly_customers_customers__placed__shipped__completed__returned [RUN]
02:47:41.438743 [debug] [Thread-2  ]: Began running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:47:41.438930 [info ] [Thread-2  ]: 2 of 5 START test not_null_monthly_customers_customers.......................... [RUN]
02:47:41.439343 [debug] [Thread-3  ]: Began running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:47:41.439530 [info ] [Thread-3  ]: 3 of 5 START test not_null_monthly_customers_month.............................. [RUN]
02:47:41.439963 [debug] [Thread-4  ]: Began running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:47:41.440153 [info ] [Thread-4  ]: 4 of 5 START test unique_monthly_customers_customers............................ [RUN]
02:47:41.440467 [debug] [Thread-5  ]: Began running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:47:41.440692 [info ] [Thread-5  ]: 5 of 5 START test unique_monthly_customers_month................................ [RUN]
02:47:41.441801 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615"
02:47:41.441998 [debug] [Thread-1  ]: Began compiling node test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615
02:47:41.442222 [debug] [Thread-1  ]: Compiling test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615
02:47:41.450060 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:47:41.450259 [debug] [Thread-2  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:47:41.450424 [debug] [Thread-2  ]: Compiling test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:47:41.467619 [debug] [Thread-1  ]: Writing injected SQL for node "test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615"
02:47:41.475949 [debug] [Thread-1  ]: finished collecting timing info
02:47:41.474691 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:47:41.476368 [debug] [Thread-4  ]: Began compiling node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:47:41.476580 [debug] [Thread-4  ]: Compiling test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:47:41.475046 [debug] [Thread-5  ]: Acquiring new bigquery connection "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:47:41.483666 [debug] [Thread-5  ]: Began compiling node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:47:41.483869 [debug] [Thread-5  ]: Compiling test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:47:41.474087 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:47:41.489316 [debug] [Thread-3  ]: Began compiling node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:47:41.489495 [debug] [Thread-3  ]: Compiling test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:47:41.476179 [debug] [Thread-1  ]: Began executing node test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615
02:47:41.473658 [debug] [Thread-2  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:47:41.502991 [debug] [Thread-2  ]: finished collecting timing info
02:47:41.503182 [debug] [Thread-2  ]: Began executing node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:47:41.489082 [debug] [Thread-5  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:47:41.518020 [debug] [Thread-5  ]: finished collecting timing info
02:47:41.518266 [debug] [Thread-5  ]: Began executing node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:47:41.493305 [debug] [Thread-3  ]: Writing injected SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:47:41.523989 [debug] [Thread-3  ]: finished collecting timing info
02:47:41.524209 [debug] [Thread-3  ]: Began executing node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:47:41.502514 [debug] [Thread-4  ]: Writing injected SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:47:41.547513 [debug] [Thread-4  ]: finished collecting timing info
02:47:41.547704 [debug] [Thread-4  ]: Began executing node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:47:41.539375 [debug] [Thread-3  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"
02:47:41.537349 [debug] [Thread-5  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"
02:47:41.552779 [debug] [Thread-5  ]: Opening a new connection, currently in state init
02:47:41.553050 [debug] [Thread-5  ]: On test.coffee_shop.unique_monthly_customers_month.815e02ad2e: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_month.815e02ad2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select month as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where month is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:47:41.554086 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:47:41.554299 [debug] [Thread-3  ]: On test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where month is null



      
    ) dbt_internal_test
02:47:41.552194 [debug] [Thread-1  ]: Writing runtime SQL for node "test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615"
02:47:41.557549 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:47:41.557767 [debug] [Thread-1  ]: On test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customers as value_field,
        count(*) as n_records

    from `ae-project-341501`.`coffee_shop`.`monthly_customers`
    group by customers

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','returned'
)



      
    ) dbt_internal_test
02:47:41.549961 [debug] [Thread-4  ]: Writing runtime SQL for node "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"
02:47:41.547024 [debug] [Thread-2  ]: Writing runtime SQL for node "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"
02:47:41.560803 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:47:41.561014 [debug] [Thread-2  ]: On test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `ae-project-341501`.`coffee_shop`.`monthly_customers`
where customers is null



      
    ) dbt_internal_test
02:47:41.560363 [debug] [Thread-4  ]: Opening a new connection, currently in state init
02:47:41.562832 [debug] [Thread-4  ]: On test.coffee_shop.unique_monthly_customers_customers.03f6f568f5: /* {"app": "dbt", "dbt_version": "1.0.3", "profile_name": "coffee_shop", "target_name": "dev", "node_id": "test.coffee_shop.unique_monthly_customers_customers.03f6f568f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select customers as unique_field
  from `ae-project-341501`.`coffee_shop`.`monthly_customers`
  where customers is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
02:47:41.951832 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/ae-project-341501/queries/b124ef2c-6c24-4f75-a824-3a4edc8d13f2?maxResults=0&location=US&prettyPrint=false: No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]')
02:47:42.811051 [debug] [Thread-1  ]: finished collecting timing info
02:47:42.811556 [debug] [Thread-1  ]: Database Error in test accepted_values_monthly_customers_customers__placed__shipped__completed__returned (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled SQL at target/run/coffee_shop/models/schema.yml/accepted_values_monthly_custom_e2d6e6465c820c940286120c7fa94ed4.sql
02:47:42.811879 [error] [Thread-1  ]: 1 of 5 ERROR accepted_values_monthly_customers_customers__placed__shipped__completed__returned [[31mERROR[0m in 1.37s]
02:47:42.813384 [debug] [Thread-1  ]: Finished running node test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615
02:47:42.870830 [debug] [Thread-3  ]: finished collecting timing info
02:47:42.871404 [info ] [Thread-3  ]: 3 of 5 PASS not_null_monthly_customers_month.................................... [[32mPASS[0m in 1.40s]
02:47:42.874897 [debug] [Thread-3  ]: Finished running node test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6
02:47:42.900847 [debug] [Thread-2  ]: finished collecting timing info
02:47:42.901311 [info ] [Thread-2  ]: 2 of 5 PASS not_null_monthly_customers_customers................................ [[32mPASS[0m in 1.45s]
02:47:42.902585 [debug] [Thread-2  ]: Finished running node test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7
02:47:42.911662 [debug] [Thread-4  ]: finished collecting timing info
02:47:42.912053 [info ] [Thread-4  ]: 4 of 5 PASS unique_monthly_customers_customers.................................. [[32mPASS[0m in 1.44s]
02:47:42.913194 [debug] [Thread-4  ]: Finished running node test.coffee_shop.unique_monthly_customers_customers.03f6f568f5
02:47:43.219209 [debug] [Thread-5  ]: finished collecting timing info
02:47:43.219720 [info ] [Thread-5  ]: 5 of 5 PASS unique_monthly_customers_month...................................... [[32mPASS[0m in 1.74s]
02:47:43.221147 [debug] [Thread-5  ]: Finished running node test.coffee_shop.unique_monthly_customers_month.815e02ad2e
02:47:43.222706 [debug] [MainThread]: Acquiring new bigquery connection "master"
02:47:43.223101 [info ] [MainThread]: 
02:47:43.224148 [info ] [MainThread]: Finished running 5 tests in 2.52s.
02:47:43.226250 [debug] [MainThread]: Connection 'master' was properly closed.
02:47:43.226441 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_customers.5756e74ea7' was properly closed.
02:47:43.226604 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_monthly_customers_customers__placed__shipped__completed__returned.7265001615' was properly closed.
02:47:43.226749 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_monthly_customers_month.3dddb9d0e6' was properly closed.
02:47:43.226888 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_customers.03f6f568f5' was properly closed.
02:47:43.227024 [debug] [MainThread]: Connection 'test.coffee_shop.unique_monthly_customers_month.815e02ad2e' was properly closed.
02:47:43.233763 [info ] [MainThread]: 
02:47:43.235020 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:47:43.236156 [info ] [MainThread]: 
02:47:43.237318 [error] [MainThread]: [33mDatabase Error in test accepted_values_monthly_customers_customers__placed__shipped__completed__returned (models/schema.yml)[0m
02:47:43.245114 [error] [MainThread]:   No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
02:47:43.246168 [error] [MainThread]:   compiled SQL at target/run/coffee_shop/models/schema.yml/accepted_values_monthly_custom_e2d6e6465c820c940286120c7fa94ed4.sql
02:47:43.247182 [info ] [MainThread]: 
02:47:43.248287 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
02:47:43.249512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8e47310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8d40ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3e8d406a0>]}
